(this["webpackJsonpReact-Multiplicate"]=this["webpackJsonpReact-Multiplicate"]||[]).push([[0],Array(35).concat([function(e,t,a){},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),i=a(18),c=a.n(i),r=(a(35),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,74)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),i(e),c(e)}))}),o=a(3),l=(a(41),a(10)),u=(a(42),"CHANGE_CANVAS_SIZE"),h="SET_CANVAS",d="CHANGE_CURRENT_TOOL",v="SET_CANVAS_BLOCK",f="SET_CANVAS_POSITION",m="SET_CANVAS_ZOOM",p="CHANGE_BRUSH_SETTING",j="SAVE_BRUSH",g="CHANGE_CANVAS_DEFAULT_BACKGROUND",b="CHANGE_SAVED_BRUSHES",y="CHANGE_ERASER_SETTING",_="CHANGE_LAYOUT_LIST",x="CHANGE_CURRENT_LAYOUT",O="CHANGE_FRAME_LIST",C="SET_MULTIPLICATE_CANVAS",k="STOP_PLAY",L="CAN_PLAY",w="SET_CURRENT_FRAME",S="IMAGE_TOOL_SET_FILE",N="IMAGE_TOOL_DRAG_BLOCK_ENABLE",I="IMAGE_TOOL_DRAG_BLOCK_DISABLE",A="IMAGE_TOOL_SET_POSITION",T="IMAGE_TOOL_ACCEPT_CHANGES",E="IMAGE_TOOL_FINISH",R="IMAGE_TOOL_CAN_START";function M(e,t){return{type:u,payload:{width:e,height:t}}}function B(e,t){return{type:h,payload:{canvas:e,context:t}}}function D(e,t){return{type:d,payload:{currentTool:e,currentToolName:t}}}function H(e){return{type:v,payload:e}}function z(e){return{type:f,payload:e}}function F(e){return{type:m,payload:e}}a(43);var P=a(0);var G=Object(o.b)((function(e){return{width:e.canvas.size.width,height:e.canvas.size.height,top:e.canvas.position.top,left:e.canvas.position.left,tmpCanvas:e.canvas.tmpCanvas,canvasZoom:e.canvas.zoom}}),(function(e){return{setCanvas:Object(l.a)(B,e)}}))((function(e){var t=s.a.createRef(),a=e.setCanvas;return Object(n.useEffect)((function(){var e=t.current.getContext("2d");return a(t.current,e),function(){}}),[t,a]),Object(P.jsx)(s.a.Fragment,{children:Object(P.jsx)("canvas",{ref:t,height:e.height,width:e.width,className:"canvas",style:{top:e.top,left:e.left,transform:"scale(".concat(e.canvasZoom,")")}})})})),Y=a(5),W=a(6),X=a(15),K=a(14),U=a(2),Z={canvas:null,canvasBlock:null,context:null,size:{width:"100px",height:"100px"},position:{top:"1px",left:"1px"},currentTool:null,currentToolName:"",zoom:1};var V={canvasDefaultBackground:"#ececec"};var J={layoutList:[],currentLayout:null,currentLayoutIndex:0,changeCurrentCanvas:!0};var q={frameList:[],frameCanvas:null,stopPlay:!0,currentFrameIndex:0};var Q={color:"#ff0f00",size:"20",alpha:1,savedBrushes:[]};var $={file:null,dragBlockEnabled:!0,position:{x:0,y:0,width:100,height:100,changed:!1},finish:!1};var ee={size:"20",alpha:1};var te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(U.a)(Object(U.a)({},e),t.payload);default:return Object(U.a)({},e)}},ae=Object(l.b)({brush:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(U.a)(Object(U.a)({},e),t.payload);case j:return Object(U.a)(Object(U.a)({},e),{},{savedBrushes:e.savedBrushes.concat(t.payload)});case b:return Object(U.a)(Object(U.a)({},e),{},{savedBrushes:Array.from(t.payload)});default:return e}},image:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(U.a)(Object(U.a)({},e),{},{file:t.payload});case I:return Object(U.a)(Object(U.a)({},e),{},{dragBlockEnabled:!1});case N:return Object(U.a)(Object(U.a)({},e),{},{dragBlockEnabled:!0});case A:return Object(U.a)(Object(U.a)({},e),{},{position:Object(U.a)(Object(U.a)({},t.payload),{},{changed:!0})});case T:return Object(U.a)(Object(U.a)({},e),{},{position:Object(U.a)(Object(U.a)({},e.position),{},{changed:!1})});case E:return Object(U.a)(Object(U.a)({},e),{},{finish:!e.finish});case R:return Object(U.a)(Object(U.a)({},e),{},{finish:!1});default:return Object(U.a)({},e)}},eraser:te}),ne=Object(l.b)({canvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return Object(U.a)(Object(U.a)({},e),{},{size:{width:t.payload.width,height:t.payload.height}});case h:return Object(U.a)(Object(U.a)({},e),{},{canvas:t.payload.canvas,context:t.payload.context});case d:return Object(U.a)(Object(U.a)({},e),{},{currentTool:t.payload.currentTool,currentToolName:t.payload.currentToolName});case v:return Object(U.a)(Object(U.a)({},e),{},{canvasBlock:t.payload});case f:return Object(U.a)(Object(U.a)({},e),{},{position:t.payload});case m:return Object(U.a)(Object(U.a)({},e),{},{zoom:t.payload});default:return e}},tool:ae,setting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return Object(U.a)({},e);default:return e}},layouts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(U.a)(Object(U.a)({},e),{},{layoutList:Array.from(t.payload)});case x:return Object(U.a)(Object(U.a)({},e),{},{currentLayout:t.payload.currentLayout,currentLayoutIndex:t.payload.currentLayoutIndex,changeCurrentCanvas:!e.changeCurrentCanvas});default:return e}},frames:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(U.a)(Object(U.a)({},e),{},{frameList:t.payload.frameList.concat()});case C:return Object(U.a)(Object(U.a)({},e),{},{frameCanvas:t.payload});case k:return Object(U.a)(Object(U.a)({},e),{},{stopPlay:!0});case L:return Object(U.a)(Object(U.a)({},e),{},{stopPlay:!1});case w:return Object(U.a)(Object(U.a)({},e),{},{currentFrameIndex:t.payload});default:return e}}}),se=Object(l.c)(ne),ie=function(){function e(t){Object(Y.a)(this,e),this._listeners=t}return Object(W.a)(e,[{key:"addListener",value:function(e,t,a){var n={element:e,event:t,func:a};this._listeners.push(n),e.addEventListener(t,a)}},{key:"removeLastListener",value:function(){var e=this._listeners.pop();e.element.removeEventListener(e.event,e.func)}},{key:"removeListenersByEvent",value:function(e,t){for(var a=0;a<this._listeners.length;a++)if(this._listeners[a].event===t&&this._listeners[a].element===e){var n=this._listeners[a];n.element.removeEventListener(n.event,n.func),this._listeners.splice(a,1)}}},{key:"removeListener",value:function(e,t,a){for(var n=0;n<this._listeners.length;n++)if(this._listeners[n].event===t&&this._listeners[n].element===e&&JSON.stringify(this._listeners[n].func)===JSON.stringify(a)){var s=this._listeners[n];s.element.removeEventListener(s.event,s.func),this._listeners.splice(n,1)}}},{key:"removeAllListener",value:function(){for(;0!==this._listeners.length;){var e=this._listeners.pop();e.element.removeEventListener(e.event,e.func)}}}]),e}(),ce=function(){function e(){Object(Y.a)(this,e)}return Object(W.a)(e,null,[{key:"hexToRgb",value:function(e){return"#"===e[0]&&(e=e.slice(1)),"rgba("+parseInt(e.slice(0,2),16)+","+parseInt(e.slice(2,4),16)+","+parseInt(e.slice(4),16)+")"}},{key:"hexToRgba",value:function(e,t){return"#"===e[0]&&(e=e.slice(1)),"rgba("+parseInt(e.slice(0,2),16)+","+parseInt(e.slice(2,4),16)+","+parseInt(e.slice(4),16)+","+t+")"}},{key:"rgbToHex",value:function(e){return"#"+(e=e.replace(/[\s()rgba;]/gi,"").split(",").map((function(e,t,a){return 1===(e=parseInt(e,10).toString(16)).length&&(e="0"+e),e})).join(""))}},{key:"toRgba",value:function(t,a){if(t.startsWith("rgba")){var n=e.rgbaToHex(t);return e.hexToRgba(n,a)}if(t.startsWith("rgb")){var s=e.rgbToHex(t);return this.hexToRgba(s,a)}return this.hexToRgba(t,a)}},{key:"rgbaToHex",value:function(e){return"#"+(e=e.replace(/[\s()rgba;]/gi,"")).split(",").map((function(e,t,a){return t===a.length-1?"del":(1===(e=parseInt(e,10).toString(16)).length&&(e="0"+e),e)})).filter((function(e){return"del"!==e})).join("")}},{key:"toHex",value:function(t){return t.startsWith("#")?t:t.startsWith("rgba")?e.rgbaToHex(t):e.rgbToHex(t)}}]),e}(),re=function(){function e(){Object(Y.a)(this,e)}return Object(W.a)(e,[{key:"create",value:function(){}},{key:"destroy",value:function(){}},{key:"setLayout",value:function(e,t){this._canvas=e,this._ctx=t}},{key:"_setCanvasStyle",value:function(e){var t=se.getState();e.style.zIndex=75,e.height=t.canvas.size.height,e.width=t.canvas.size.width,e.style.top=t.canvas.position.top,e.style.left=t.canvas.position.left,e.style.position="absolute",e.style.transform="scale(".concat(t.canvas.zoom,")"),e.classList.add("tmpCanvas")}},{key:"_init",value:function(){var e=se.getState();this._currentLayout=e.layouts.currentLayout;var t=this._currentLayout.getCanvas();this._canvas=t;var a=t.getContext("2d");this._ctx=a;var n=e.canvas.canvasBlock;this._workspace=n;var s=document.createElement("canvas");this._tmpCanvas=s,this._setCanvasStyle(s),this._workspace.append(s),this._tmpCtx=s.getContext("2d")}}]),e}();function oe(e){return{type:p,payload:e}}var le=function(e){Object(X.a)(a,e);var t=Object(K.a)(a);function a(){var e;return Object(Y.a)(this,a),(e=t.call(this))._listenerManager=new ie([]),e}return Object(W.a)(a,[{key:"setColor",value:function(e){var t=se.getState();isFinite(t.tool.brush.alpha)&&(e=ce.toRgba(e,t.tool.brush.alpha)),se.dispatch(oe({color:e}))}},{key:"getColor",value:function(){var e=se.getState();return ce.toHex(e.tool.brush.color)}},{key:"setAlpha",value:function(e){e=Math.floor(100*e)/100,se.dispatch(oe({alpha:e}));var t=se.getState();this.setColor(t.tool.brush.color)}},{key:"getAlpha",value:function(){return se.getState().tool.brush.alpha}},{key:"setSize",value:function(e){se.dispatch(oe({size:e}))}},{key:"getSize",value:function(){return se.getState().brush.size}}]),a}(re),ue=a(30);function he(e){return{type:_,payload:e}}function de(e,t){return{type:x,payload:{currentLayout:e,currentLayoutIndex:t}}}var ve=function(){function e(t,a,n,s){Object(Y.a)(this,e),this._canvas=t,this._ctx=a,this._show=n,this._name=null,this._historyArr=[],this._positionInHistory=-1,this.saveInHistory(),this.selected=!1,this.id=s}return Object(W.a)(e,[{key:"getId",value:function(){return this.id}},{key:"toggleHide",value:function(){this._show?this._show=!1:this._show=!0}},{key:"isHidden",value:function(){return!this._show}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getContext",value:function(){return this._ctx}},{key:"clear",value:function(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._historyArr=[]}},{key:"saveInHistory",value:function(){this._positionInHistory!==this._historyArr.length-1&&(this._historyArr=this._historyArr.slice(0,this._positionInHistory+1)),this._historyArr.length>40&&this._historyArr.shift(),this._historyArr.push(this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)),this._positionInHistory=this._historyArr.length-1}},{key:"historyBack",value:function(){0!==this._positionInHistory&&(this._positionInHistory-=1,this._ctx.putImageData(this._historyArr[this._positionInHistory],0,0),fe.update())}},{key:"historyNext",value:function(){this._positionInHistory!==this._historyArr.length-1&&(this._positionInHistory+=1,this._ctx.putImageData(this._historyArr[this._positionInHistory],0,0),fe.update())}},{key:"select",value:function(){this.selected=!this.selected}},{key:"isSelected",value:function(){return this.selected}}]),e}(),fe=function(){function e(){Object(Y.a)(this,e)}return Object(W.a)(e,null,[{key:"init",value:function(){var t=se.getState(),a=t.canvas.canvas,n=t.canvas.context,s=t.layouts.layoutList,i=t.layouts.currentLayoutIndex;if(0===s.length){var c=document.createElement("canvas");c.width=t.canvas.size.width,c.height=t.canvas.size.height;var r=c.getContext("2d");r.putImageData(n.createImageData(a.width,a.height),0,0);var o=new ve(c,r,!0,++e.id);s.push(o),se.dispatch(he(s)),se.dispatch(de(o,i))}this.update(),se.dispatch(he(t.layouts.layoutList))}},{key:"update",value:function(){var e=se.getState(),t=e.layouts.layoutList,a=e.canvas.context;a.clearRect(0,0,e.canvas.size.width,e.canvas.size.height);for(var n=0;n<t.length;n++)t[n].isHidden()||a.drawImage(t[n].getCanvas(),0,0)}},{key:"changeLayoutList",value:function(e){se.dispatch(he(e)),this.update()}},{key:"addLayout",value:function(){var t=se.getState(),a=t.layouts.layoutList,n=document.createElement("canvas");n.width=t.canvas.size.width,n.height=t.canvas.size.height;var s=n.getContext("2d"),i=new ve(n,s,!0,++e.id);a.splice(t.layouts.currentLayoutIndex+1,0,i),se.dispatch(de(i,t.layouts.currentLayoutIndex+1)),se.dispatch(he(a))}},{key:"copyLayouts",value:function(){var t=se.getState(),a=t.layouts.layoutList,n=Array.from(a),s=0;a.forEach((function(a,i){if(a.isSelected()){var c=document.createElement("canvas");c.width=t.canvas.size.width,c.height=t.canvas.size.height;var r=c.getContext("2d");r.drawImage(t.layouts.layoutList[i].getCanvas(),0,0);var o=new ve(c,r,!0,++e.id);n.splice(i+s,0,o),s++}})),se.dispatch(he(n))}},{key:"getCurrentLayout",value:function(){return se.getState().layouts.currentLayout}},{key:"setCurrentLayout",value:function(e){if(se.getState().layouts.layoutList[e]){var t=se.getState().layouts.layoutList[e];se.dispatch(de(t,e))}}},{key:"getCurrentLayoutIndex",value:function(){return+se.getState().layouts.currentLayoutIndex}},{key:"toggleHide",value:function(e){var t=se.getState();e=+e,t.layouts.layoutList[e].toggleHide(),se.dispatch(he(t.layouts.layoutList)),this.update()}},{key:"deleteLayout",value:function(e){var t=se.getState(),a=t.layouts.layoutList,n=t.layouts.currentLayout,s=t.layouts.currentLayoutIndex;if(a.length<=1)return n.clear(),void this.update();a.splice(e,1),s>=e?this.setCurrentLayout(s-1):this.setCurrentLayout(s),se.dispatch(he(t.layouts.layoutList)),this.update()}},{key:"deleteSelectedLayouts",value:function(){var t=se.getState(),a=t.layouts.layoutList,n=t.layouts.currentLayout,s=t.layouts.currentLayoutIndex,i=a.filter((function(e){return!e.isSelected()}));if(0===i.length){var c=document.createElement("canvas");c.width=t.canvas.size.width,c.height=t.canvas.size.height;var r=c.getContext("2d"),o=new ve(c,r,!0,++e.id);i.push(o)}se.dispatch(he(i)),-1===(s=i.indexOf(n))?this.setCurrentLayout(0):this.setCurrentLayout(s),this.update()}},{key:"swap",value:function(e,t){var a=se.getState(),n=a.layouts.layoutList,s=a.layouts.currentLayout;if(n[e]&&n[t]){var i=n[e];n[e]=n[t],n[t]=i;var c=n.indexOf(s);this.setCurrentLayout(c),this.update(),se.dispatch(he(a.layouts.layoutList))}}},{key:"combineSelected",value:function(){var e=se.getState().layouts.layoutList,t=e.filter((function(e){return e.isSelected()})),a=[];t.forEach((function(t){a.push(e.indexOf(t))}));var n=Math.min.apply(Math,Object(ue.a)(a)),s=e[n];t.forEach((function(e,t){0!==t&&s.getContext().drawImage(e.getCanvas(),0,0)})),a=a.slice(1),s.saveInHistory(),e=e.filter((function(e,t){return!a.includes(t)})),se.dispatch(he(e)),this.setCurrentLayout(n)}},{key:"getLayoutList",value:function(){return se.getState().layouts.layoutList}},{key:"setLayout",value:function(e,t){se.getState().layouts.layoutList[t]=e,this.update()}},{key:"select",value:function(e){var t=se.getState().layouts.layoutList;t[e].select(),se.dispatch(he(t)),this.update()}},{key:"unSelectAll",value:function(){var e=se.getState().layouts.layoutList;e.forEach((function(e){e.isSelected()&&e.select()})),se.dispatch(he(e)),this.update()}}]),e}();fe.id=0;var me=function(e){Object(X.a)(a,e);var t=Object(K.a)(a);function a(){var e;Object(Y.a)(this,a),(e=t.call(this)).started=!1;var n=se.getState();return e._canvasBlock=n.canvas.canvasBlock,e}return Object(W.a)(a,[{key:"create",value:function(){var e=this,t=[],a=document.createElement("canvas");this._fakeCanvas=a;var n=se.getState();a.style.zIndex=100,a.height=n.canvas.size.height,a.width=n.canvas.size.width,a.style.top=n.canvas.position.top,a.style.left=n.canvas.position.left,a.style.position="absolute",a.classList.add("tmpCanvas"),a.style.cursor="crosshair";var s=a.getContext("2d");function i(){if(this.started){this.started=!1,this._listenerManager.removeListener(a,"mousemove",c),this._ctx.drawImage(a,0,0);var e=se.getState();fe.update(),e.layouts.currentLayout.saveInHistory(),s.clearRect(0,0,a.width,a.height),t=[]}}this._canvasBlock.prepend(a),this._listenerManager.addListener(this._canvasBlock,"mousedown",(function(t){var n=se.getState();n.layouts.currentLayout.isHidden()?alert("\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u043c\u0438 \u0441\u043b\u043e\u0439 \u0441\u043a\u0440\u044b\u0442 !"):(e.started=!0,e._ctx=n.layouts.currentLayout.getContext(),e._canvas=n.layouts.currentLayout.getCanvas(),e._ctx.strokeStyle=n.tool.brush.color,e._ctx.lineWidth=n.tool.brush.size,e._ctx.lineCap="round",s.strokeStyle=e._ctx.strokeStyle,s.lineWidth=e._ctx.lineWidth,s.lineCap=e._ctx.lineCap,a.style.transform="scale(".concat(n.canvas.zoom,")"),a.style.top=n.canvas.position.top+"px",a.style.left=n.canvas.position.left+"px",c(t),e._listenerManager.addListener(a,"mousemove",c))})),this._listenerManager.addListener(this._canvasBlock,"mouseup",(function(){i.call(e)})),this._listenerManager.addListener(this._canvasBlock,"mouseleave",(function(){i.call(e)}));var c=function(a){var n=a.offsetX,i=a.offsetY;t.push({x:n,y:i}),s.beginPath(),s.clearRect(0,0,e._canvas.width,e._canvas.height),t.length<=3&&s.arc(t[0].x,t[0].y,0,0,2*Math.PI);for(var c=1;c<t.length-2;c++){var r=(t[c].x+t[c+1].x)/2,o=(t[c].y+t[c+1].y)/2;s.quadraticCurveTo(t[c].x,t[c].y,r,o)}s.stroke()}}},{key:"destroy",value:function(){this._listenerManager.removeAllListener(),this._fakeCanvas.remove()}}]),a}(le),pe=a(22),je=a(17),ge=function(e){Object(X.a)(a,e);var t=Object(K.a)(a);function a(){return Object(Y.a)(this,a),t.apply(this,arguments)}return Object(W.a)(a,[{key:"create",value:function(){var e=this,t=[],n=document.createElement("canvas");this._fakeCanvas=n;var s=se.getState();Object(pe.a)(Object(je.a)(a.prototype),"_setCanvasStyle",this).call(this,n),n.style.cursor="crosshair";var i=n.getContext("2d");s.canvas.canvasBlock.prepend(n),this._listenerManager.addListener(n,"mousedown",(function(t){var a=se.getState();e._ctx=a.layouts.currentLayout.getContext(),e._canvas=a.layouts.currentLayout.getCanvas(),e._ctx.lineWidth=a.tool.eraser.size,e._ctx.lineCap="round",i.lineWidth=e._ctx.lineWidth,i.lineCap=e._ctx.lineCap,e._ctx.strokeStyle=a.setting.canvasDefaultBackground,i.strokeStyle=a.setting.canvasDefaultBackground,c(t),e._listenerManager.addListener(n,"mousemove",c)})),this._listenerManager.addListener(n,"mouseup",(function(){e._listenerManager.removeListener(n,"mousemove",c);var a=function(e,t){for(var a=0;a<e.data.length;a+=4)255===e.data[a+3]&&(t.data[a+3]=0);return t}(i.getImageData(0,0,n.width,n.height),e._ctx.getImageData(0,0,n.width,n.height));e._ctx.putImageData(a,0,0),fe.update(),s.layouts.currentLayout.saveInHistory(),i.clearRect(0,0,n.width,n.height),t=[]}));var c=function(a){var n=a.offsetX,s=a.offsetY;t.push({x:n,y:s}),i.beginPath(),i.clearRect(0,0,e._canvas.width,e._canvas.height),t.length<=3&&i.arc(t[0].x,t[0].y,0,0,2*Math.PI);for(var c=1;c<t.length-2;c++){var r=(t[c].x+t[c+1].x)/2,o=(t[c].y+t[c+1].y)/2;i.quadraticCurveTo(t[c].x,t[c].y,r,o)}i.stroke()}}},{key:"destroy",value:function(){this._listenerManager.removeAllListener(),this._fakeCanvas.remove()}}]),a}(le);var be=function(e){Object(X.a)(a,e);var t=Object(K.a)(a);function a(){var e;return Object(Y.a)(this,a),(e=t.call(this))._listenerManager=new ie([]),e}return Object(W.a)(a,[{key:"create",value:function(){var e=this,t=se.getState(),a=t.canvas.canvas,n=t.canvas.canvasBlock,s=0,i=0;function c(e){var t=se.getState(),a=-(s-e.clientY),n=-(i-e.clientX);se.dispatch(z({top:parseInt(t.canvas.position.top)+a+"px",left:parseInt(t.canvas.position.left)+n+"px"})),s+=a,i+=n}a.style.cursor="move",this._listenerManager.addListener(a,"mousedown",(function(t){s=t.clientY,i=t.clientX,e._listenerManager.addListener(n,"mousemove",c)})),this._listenerManager.addListener(a,"mouseup",(function(t){e._listenerManager.removeListener(n,"mousemove",c),e._listenerManager.removeListener(n,"mouseleave",c)})),this._listenerManager.addListener(a,"mouseleave",(function(t){e._listenerManager.removeListener(n,"mousemove",c),e._listenerManager.removeListener(n,"mouseleave",c)})),this._listenerManager.addListener(a,"contextmenu",(function(){se.dispatch(F(1.5))}))}},{key:"destroy",value:function(){var e=se.getState().canvas.canvas;this._listenerManager.removeAllListener(),e.style.cursor="default"}}]),a}(re),ye=function(e){Object(X.a)(a,e);var t=Object(K.a)(a);function a(){var e;return Object(Y.a)(this,a),(e=t.call(this))._listenerManager=new ie([]),e._rect=[],e._painted=!1,e._currentLayout=null,e._canvas=null,e._ctx=null,e._selectedAreaImageData=null,e._canvasWithoutSelectedArea=null,e}return Object(W.a)(a,[{key:"create",value:function(){var e=this;this._init();var t=this._tmpCanvas,a=this._tmpCtx,n=0,s=0;this._unsubscribe=se.subscribe((function(){var n=se.getState();console.log("change layout"),e._currentLayout!==n.layouts.currentLayout&&(e._rect=[],e._currentLayout=n.layouts.currentLayout,e._canvas=e._currentLayout.getCanvas(),e._ctx=e._currentLayout.getContext(),e._selectedAreaImageData=null,e._canvasWithoutSelectedArea=null,e._painted=!1,a.clearRect(0,0,t.width,t.height))})),this._listenerManager.addListener(t,"mousedown",(function(i){n=i.offsetX,s=i.offsetY,e._painted?e._moveRectFunction(t,a,n,s):e._selectArea(t,a,n,s)}))}},{key:"_selectArea",value:function(e,t,a,n){var s=this,i=!1;this._listenerManager.addListener(e,"mousemove",(function(s){t.clearRect(0,0,e.width,e.height),t.strokeRect(a,n,s.offsetX-a,s.offsetY-n),i=!0})),this._listenerManager.addListener(e,"mouseup",(function(t){s._rect=[a,n,t.offsetX,t.offsetY],a>t.offsetX&&(s._rect[0]=t.offsetX,s._rect[2]=a),n>t.offsetY&&(s._rect[1]=t.offsetY,s._rect[3]=n);var c=s._rect[2]-s._rect[0]!==0&&s._rect[3]-s._rect[1]!==0;if(s._painted=!(!i||!c),s._painted){var r=document.createElement("canvas");r.width=s._canvas.width,r.height=s._canvas.height;var o=r.getContext("2d");o.drawImage(s._canvas,0,0),o.clearRect(s._rect[0],s._rect[1],s._rect[2]-s._rect[0],s._rect[3]-s._rect[1]),s._canvasWithoutSelectedArea=r,s._selectedAreaImageData=s._ctx.getImageData(s._rect[0],s._rect[1],s._rect[2]-s._rect[0],s._rect[3]-s._rect[1])}s._listenerManager.removeListenersByEvent(e,"mousemove"),s._listenerManager.removeListenersByEvent(e,"mouseup")}))}},{key:"_moveRectFunction",value:function(e,t,a,n){var s=this;if(0!==this._rect.length&&a>this._rect[0]&&a<this._rect[2]&&n>this._rect[1]&&n<this._rect[3]){var i=this._selectedAreaImageData,c=a-this._rect[0],r=n-this._rect[1];this._listenerManager.addListener(e,"mousemove",(function(a){t.clearRect(0,0,e.width,e.height),t.strokeRect(a.offsetX-c,a.offsetY-r,i.width,i.height),t.putImageData(i,a.offsetX-c,a.offsetY-r)})),this._listenerManager.addListener(e,"mouseup",(function(a){t.clearRect(0,0,e.width,e.height),t.putImageData(i,a.offsetX-c,a.offsetY-r),s._ctx.clearRect(0,0,s._canvas.width,s._canvas.height),s._ctx.drawImage(s._canvasWithoutSelectedArea,0,0),s._ctx.drawImage(s._tmpCanvas,0,0),t.strokeRect(a.offsetX-c,a.offsetY-r,i.width,i.height),s._rect=[a.offsetX-c,a.offsetY-r,a.offsetX-c+i.width,a.offsetY-r+i.height],s._listenerManager.removeListenersByEvent(e,"mousemove"),s._listenerManager.removeListenersByEvent(e,"mouseup"),s._currentLayout.saveInHistory(),fe.update()}))}else this._painted=!1,t.clearRect(0,0,e.width,e.height)}},{key:"destroy",value:function(){this._listenerManager.removeAllListener(),this._tmpCanvas.remove(),this._unsubscribe()}}]),a}(re);function _e(){return{type:I}}function xe(e){return{type:S,payload:e}}function Oe(e){return{type:A,payload:e}}function Ce(){return{type:E}}function ke(){return{type:R}}var Le=function(e){Object(X.a)(a,e);var t=Object(K.a)(a);function a(){var e;return Object(Y.a)(this,a),(e=t.call(this))._listenerManager=new ie([]),e._tmpCanvasListenerManager=new ie([]),e._rect=[],e._painted=!1,e._dragBlock=null,e._unsubscribe=null,e._workspace=null,e._tmpCanvas=null,e._tmpCtx=null,e}return Object(W.a)(a,[{key:"create",value:function(){var e=this;Object(pe.a)(Object(je.a)(a.prototype),"_init",this).call(this);var t=se.getState().canvas.zoom;this._unsubscribe=se.subscribe((function(){var n=se.getState();if(n.tool.image.file&&n.tool.image.dragBlockEnabled&&(e._dragBlock.remove(),se.dispatch(_e()),e._initTmpCanvas()),n.tool.image.file||n.tool.image.dragBlockEnabled||(e._workspace.append(e._dragBlock),e._tmpCanvasListenerManager.removeAllListener(),e._removeTmpCanvasLogic(),se.dispatch({type:N})),n.tool.image.position.changed){var s=n.tool.image.file,i=n.tool.image.position;e._tmpCtx.clearRect(0,0,e._tmpCanvas.width,e._tmpCanvas.height),e._tmpCtx.drawImage(s,i.x,i.y,i.width,i.height),e._rect=[i.x,i.y,i.x+ +i.width,i.y+ +i.height],se.dispatch({type:T})}n.tool.image.finish&&(n.layouts.currentLayout.getContext().drawImage(e._tmpCanvas,0,0),e._tmpCtx.clearRect(0,0,e._tmpCanvas.width,e._tmpCanvas.height),e._currentLayout.saveInHistory(),se.dispatch(ke()),se.dispatch(xe(null)),fe.update());if(n.canvas.zoom!==t){t=n.canvas.zoom,e._removeTmpCanvasLogic("wtf"),e._getDragBlockStyle(e._dragBlock),Object(pe.a)(Object(je.a)(a.prototype),"_setCanvasStyle",e).call(e,e._tmpCanvas);var c=n.tool.image.file;if(c){var r=n.tool.image.position;e._tmpCtx.clearRect(0,0,e._tmpCanvas.width,e._tmpCanvas.height),e._tmpCtx.drawImage(c,r.x,r.y,r.width,r.height),e._initTmpCanvas()}}})),this._initDragBlock()}},{key:"_initDragBlock",value:function(){var e=this,t=document.createElement("div");this._dragBlock=t,this._getDragBlockStyle(t),this._workspace.append(t),t.addEventListener("drop",(function(t){t.preventDefault();var a=t.dataTransfer.files;if(a[0].type.startsWith("image")){var n=new FileReader;n.readAsDataURL(a[0]),n.onload=function(){var a=t.offsetX,s=t.offsetY,i=new Image;i.src=n.result,i.onload=function(){se.dispatch(xe(i)),se.dispatch(Oe({x:a,y:s,width:i.width,height:i.height})),e._rect=[t.offsetX,t.offsetY,t.offsetX+i.width,t.offsetX+i.height],fe.update()}}}else alert("FAIL!")})),t.addEventListener("dragover",(function(e){e.preventDefault()}))}},{key:"_getDragBlockStyle",value:function(e){var t=se.getState();e.style.zIndex=100,e.style.height=t.canvas.size.height+"px",e.style.width=t.canvas.size.width+"px",e.style.top=t.canvas.position.top,e.style.left=t.canvas.position.left,e.style.position="absolute",e.style.transform="scale(".concat(t.canvas.zoom,")"),e.classList.add("drag-block"),e.innerHTML="\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0441\u044e\u0434\u0430"}},{key:"_initTmpCanvas",value:function(){var e=this;this._tmpCanvasListenerManager.addListener(this._tmpCanvas,"mousedown",(function(t){var a=t.offsetX,n=t.offsetY,s=e._tmpCanvas,i=e._tmpCtx,c=se.getState().tool.image.position;if(console.log(a),console.log(n),console.log("LOL MOUSE DOWN !"),null!==e._rect.length&&a>e._rect[0]&&a<e._rect[2]&&n>e._rect[1]&&n<e._rect[3]){var r=a-e._rect[0],o=n-e._rect[1];e._tmpCanvasListenerManager.addListener(s,"mousemove",(function(e){se.dispatch(Oe({x:e.offsetX-r,y:e.offsetY-o,width:c.width,height:c.height}))})),e._tmpCanvasListenerManager.addListener(s,"mouseup",(function(t){e._tmpCanvasListenerManager.removeListenersByEvent(s,"mousemove"),e._tmpCanvasListenerManager.removeListenersByEvent(s,"mouseup"),fe.update()}))}else se.dispatch(Ce()),i.clearRect(0,0,s.width,s.height)}))}},{key:"_removeTmpCanvasLogic",value:function(){this._tmpCanvasListenerManager.removeAllListener()}},{key:"destroy",value:function(){this._dragBlock.remove(),this._unsubscribe(),this._tmpCanvas.remove(),this._tmpCanvasListenerManager.removeAllListener(),se.dispatch(_e()),se.dispatch(ke()),se.dispatch(xe(null))}}]),a}(re),we="SKETCH_BRUSH",Se="ERASER",Ne="HAND",Ie="DRAG",Ae="IMAGE",Te=function(){function e(){Object(Y.a)(this,e)}return Object(W.a)(e,null,[{key:"SKETCH_BRUSH",get:function(){return we}},{key:"ERASER",get:function(){return Se}},{key:"HAND",get:function(){return Ne}},{key:"DRAG",get:function(){return Ie}},{key:"IMAGE",get:function(){return Ae}},{key:"setTool",value:function(e){var t=se.getState().canvas.currentTool;switch(t&&t.destroy(),e){case we:var a=new me;a.create(),se.dispatch(D(a,we));break;case Se:var n=new ge;n.create(),se.dispatch(D(n,Se));break;case Ne:var s=new be;s.create(),se.dispatch(D(s,Ne));break;case Ie:var i=new ye;i.create(),se.dispatch(D(i,Ie));break;case Ae:var c=new Le;c.create(),se.dispatch(D(c,Ae));break;default:var r=new me;r.create(),se.dispatch(D(r,we))}}},{key:"saveBrush",value:function(e){se.dispatch({type:j,payload:e})}},{key:"changeSavedBrushes",value:function(e){se.dispatch({type:b,payload:e})}},{key:"getTool",value:function(){return se.getState().canvas.currentTool}}]),e}();function Ee(e){return{type:O,payload:{frameList:e}}}function Re(){return{type:k}}function Me(e){return{type:w,payload:e}}var Be=function(){function e(t,a,n){Object(Y.a)(this,e),this._canvas=t,this._delay=a,this._id=n,this._type="Frame",this._open=!1,this._isSelect=!1}return Object(W.a)(e,[{key:"getCanvas",value:function(){return this._canvas}},{key:"setDelay",value:function(e){this._delay=e}},{key:"getDelay",value:function(){return this._delay}},{key:"setId",value:function(e){this._id=e}},{key:"getId",value:function(){return this._id}},{key:"isOpen",value:function(){return this._open}},{key:"open",value:function(){this._open=!0}},{key:"close",value:function(){this._open=!1}},{key:"select",value:function(){this._isSelect=!0}},{key:"unSelect",value:function(){this._isSelect=!1}},{key:"isSelected",value:function(){return this._isSelect}}]),e}(),De=function(){function e(){Object(Y.a)(this,e)}return Object(W.a)(e,null,[{key:"addFrame",value:function(e,t){var a=se.getState();if(a.frames.stopPlay){var n=document.createElement("canvas"),s=a.frames.currentFrameIndex,i=a.frames.frameList;n.width=e.getCanvas().width,n.height=e.getCanvas().height,n.getContext("2d").drawImage(e.getCanvas(),0,0);var c=new Be(n,t,this.id++);i.push(c),se.dispatch(Ee(i)),-1===s&&se.dispatch(Me(0))}}},{key:"setDelaySelectedFrames",value:function(e){var t=se.getState().frames.frameList;t.forEach((function(t,a){t.isSelected()&&t.setDelay(e)})),se.dispatch(Ee(t))}},{key:"deleteSelectedFrame",value:function(){var e=se.getState().frames.frameList.filter((function(e,t){return!e.isSelected()}));se.dispatch(Ee(e)),se.dispatch(Me(e.length-1))}},{key:"unSelectAllFrame",value:function(){var e=se.getState().frames.frameList;e.forEach((function(e,t){e.isSelected()&&e.unSelect()})),se.dispatch(Ee(e))}},{key:"changeFrame",value:function(){var e=se.getState().frames.frameList;se.dispatch(Ee(e))}},{key:"deleteFrame",value:function(e){var t=se.getState();if(t.frames.stopPlay){var a=t.frames.frameList,n=t.frames.currentFrameIndex;a.splice(e,1),a.length-1<n&&se.dispatch(Me(a.length-1)),se.dispatch(Ee(a))}}},{key:"openCloseFrame",value:function(e){e.isOpen()?e.close():e.open();var t=se.getState().frames.frameList;se.dispatch(Ee(t))}},{key:"swap",value:function(e,t){var a=se.getState();if(a.frames.stopPlay){var n=a.frames.frameList;if(!(e<0||e>n.length-1||t<0||t>n.length-1)){var s=n[e];n[e]=n[t],n[t]=s,se.dispatch(Ee(n))}}}},{key:"playFilm",value:function(){var e=this,t=se.getState(),a=t.frames.frameList;if(0!==a.length||0!==a.length){var n=t.frames.currentFrameIndex,s=a[n];s.getDelay(),setTimeout((function(){var t=se.getState(),s=t.frames.stopPlay;n=t.frames.currentFrameIndex,s||(a.length-1!==n?(se.dispatch(Me(++n)),e.playFilm()):e.pause())}),s.getDelay())}else alert("\u0421\u043f\u0438\u0441\u043e\u043a \u0444\u0440\u0435\u0439\u043c\u043e\u0432 \u043f\u0443\u0441\u0442 !")}},{key:"pause",value:function(){se.dispatch(Re())}},{key:"stop",value:function(){se.dispatch(Re()),Me(0)}},{key:"set\u0421urrentFrameIndex",value:function(e){se.dispatch(Me(e))}},{key:"setMultiplicateCanvas",value:function(e){se.dispatch(function(e){return{type:C,payload:{canvas:e,context:e.getContext("2d")}}}(e))}},{key:"setDelayToAll",value:function(e){var t=se.getState().frames.frameList;t.forEach((function(t,a){t.setDelay(e)})),se.dispatch(Ee(t))}}]),e}();De.id=0;var He=Object(o.b)((function(e){return{canvas:e.canvas.canvas,context:e.canvas.context,defaultBackgorund:e.setting.canvasDefaultBackground,currentLayout:e.layouts.currentLayout,currentToolName:e.canvas.currentToolName}}),(function(e){return{changeCanvasSize:Object(l.a)(M,e),setCanvasBlock:Object(l.a)(H,e)}}))((function(e){var t=e.canvas,a=Object(n.useRef)(),s=e.changeCanvasSize,i=e.currentToolName,c=e.setCanvasBlock;return Object(n.useEffect)((function(){var e=getComputedStyle(a.current);s(parseInt(e.width)-2,parseInt(e.height)-2),null!==t&&(c(a.current),Te.setTool(i),fe.init())}),[t,s,i,c]),Object(n.useEffect)((function(){var e=new ie([]);return function(e,t){function a(e){if("KeyS"!==e.code||!e.ctrlKey){var t=fe.getCurrentLayout();return e.ctrlKey&&"KeyZ"===e.code&&e.shiftKey?(t.historyNext(),void e.preventDefault()):e.ctrlKey&&"KeyZ"===e.code?(t.historyBack(),void e.preventDefault()):"Digit1"===e.code?(Te.setTool(Te.SKETCH_BRUSH),void e.preventDefault()):"Digit2"===e.code?(Te.setTool(Te.ERASER),void e.preventDefault()):"Digit3"===e.code?(Te.setTool(Te.HAND),void e.preventDefault()):"Digit4"===e.code?(Te.setTool(Te.DRAG),void e.preventDefault()):"Digit5"===e.code?(Te.setTool(Te.IMAGE),void e.preventDefault()):"ArrowDown"===e.code?(fe.setCurrentLayout(fe.getCurrentLayoutIndex()+1),void e.preventDefault()):"ArrowUp"===e.code?(fe.setCurrentLayout(fe.getCurrentLayoutIndex()-1),void e.preventDefault()):"ArrowLeft"===e.code?(fe.getCurrentLayout().historyBack(),void e.preventDefault()):"ArrowRight"===e.code?(fe.getCurrentLayout().historyNext(),void e.preventDefault()):"KeyH"===e.code?(fe.toggleHide(fe.getCurrentLayoutIndex()),void e.preventDefault()):void 0}var a=se.getState().canvas.canvas,n=se.getState().canvas.context;if(null!=a){var s=new ve(a,n,!0,++fe.id);De.addFrame(s,100)}e.preventDefault()}function n(e){var t=se.getState().canvas.zoom;if(e.deltaY>0){if(+t+.1>5)return;se.dispatch(F((+t+.1).toFixed(2)))}else if(e.deltaY<0){if(+t-.1<=0)return;se.dispatch(F((+t-.1).toFixed(2)))}}e.addListener(window,"keydown",a),e.addListener(t,"mousewheel",n)}(e,a.current),function(){e.removeAllListener()}}),[]),Object(P.jsx)("div",{ref:a,className:"work-space",style:{backgroundColor:e.defaultBackgorund},children:Object(P.jsx)(G,{})})}));a(45);function ze(e){return Object(P.jsx)("div",{className:"top-panel",children:e.children})}var Fe=a(4),Pe=a(9);a(46);function Ge(e){var t;switch(Object(Fe.g)().pathname.match(/\/\w+/)[0]){case"/draw":t=Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(Pe.b,{to:"/save",className:"top-panel__menu-item",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(P.jsx)(Pe.b,{to:"/frames",className:"top-panel__menu-item",children:"\u0420\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043a\u0430\u0434\u0440\u0430\u043c\u0438"})]});break;case"/frames":t=Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(Pe.b,{to:"/save",className:"top-panel__menu-item",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(P.jsx)(Pe.b,{to:"/draw",className:"top-panel__menu-item",children:"\u0420\u0438\u0441\u043e\u0432\u0430\u0442\u044c"})]});break;case"/save":t=Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(Pe.b,{to:"/draw",className:"top-panel__menu-item",children:"\u0420\u0438\u0441\u043e\u0432\u0430\u0442\u044c"}),Object(P.jsx)(Pe.b,{to:"/frames",className:"top-panel__menu-item",children:"\u0420\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043a\u0430\u0434\u0440\u0430\u043c\u0438"})]});break;default:t=Object(P.jsx)(Pe.b,{to:"/draw",className:"top-panel__menu-item",children:"draw"})}return Object(P.jsxs)("div",{className:"top-panel__menu",children:[Object(P.jsx)("div",{className:"top-panel__menu-item",children:"\u0424\u0430\u0439\u043b"}),t]})}a(51),a(52);var Ye=function(e){return Object(P.jsxs)("div",{className:"brush-panel__block size-block",children:[Object(P.jsx)("div",{className:"brush-panel__panel-titile",children:e.title}),Object(P.jsxs)("div",{className:"brush-panel__inputs-block",children:[Object(P.jsx)("input",{min:e.min,max:e.max,step:e.step,onChange:e.onChange,value:e.value,type:"number"}),Object(P.jsx)("input",{min:e.min,max:e.max,step:e.step,onChange:e.onChange,value:e.value,type:"range"})]})]})};a(53);var We=Object(o.b)((function(e){return{brushSize:e.tool.brush.size,brushColor:e.tool.brush.color,brushAlpha:e.tool.brush.alpha,savedBrushes:e.tool.brush.savedBrushes}}))((function(e){var t=null,a=Object(n.useRef)();return Object(P.jsx)(P.Fragment,{children:0!==e.savedBrushes.length&&Object(P.jsxs)("div",{className:"brush-panel__block saved-brush",children:[Object(P.jsx)("div",{className:"brush-panel__panel-title",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u043a\u0438\u0441\u0442\u0438"}),Object(P.jsxs)("div",{className:"brush-panel__saved-brush",children:[Object(P.jsxs)("div",{ref:a,className:"brush-panel__saved-brush-menu ",children:[Object(P.jsx)("div",{onClick:function(){e.savedBrushes[t].size=e.brushSize,e.savedBrushes[t].color=e.brushColor,e.savedBrushes[t].alpha=e.brushAlpha,Te.changeSavedBrushes(e.savedBrushes),a.current.classList.add("fastRemove"),a.current.classList.remove("active"),setTimeout((function(){a.current.classList.remove("fastRemove")}),0)},className:"brush-panel__saved-brush-menu-item",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"}),Object(P.jsx)("div",{onClick:function(){e.savedBrushes.splice(t,1),Te.changeSavedBrushes(e.savedBrushes),a.current.classList.add("fastRemove"),a.current.classList.remove("active")},className:"brush-panel__saved-brush-menu-item",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]}),e.savedBrushes.map((function(n,s){return Object(P.jsxs)("div",{onClick:function(){!function(t){var a=e.savedBrushes[t],n=Te.getTool();n.setColor(a.color),n.setSize(a.size),n.setAlpha(a.alpha)}(s)},onContextMenu:function(e){!function(e,n){t=n,a.current.classList.add("active");var s,i=e.target.getBoundingClientRect();a.current.style.top=i.top+"px",a.current.style.left=i.left+"px",a.current.addEventListener("mouseleave",(function(){a.current.classList.add("fastRemove"),a.current.classList.remove("active"),setTimeout((function(){a.current.classList.remove("fastRemove")}),0)})),e.preventDefault(),s=setTimeout((function(){a.current.classList.remove("active")}),500),a.current.addEventListener("mouseenter",(function(e){clearTimeout(s),a.current.classList.add("active")}))}(e,s)},style:{backgroundColor:n.color},className:"brush-panel__saved-brush-item",children:["s:",n.size," o:",n.alpha]},s)}))]})]})})}));var Xe=Object(o.b)((function(e){return{brushSize:e.tool.brush.size,brushColor:e.tool.brush.color,brushAlpha:e.tool.brush.alpha,savedBrushes:e.tool.brush.savedBrushes}}))((function(e){return Object(P.jsxs)("div",{className:"brush-panel",children:[Object(P.jsx)(Ye,{title:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u0438\u0441\u0442\u0438",value:e.brushSize,onChange:function(e){Te.getTool().setSize(e.target.value)},max:"250",min:"0",step:"1"}),Object(P.jsx)(Ye,{title:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c",value:e.brushAlpha,onChange:function(e){Te.getTool().setAlpha(e.target.value)},max:"1",min:"0",step:"0.01"}),Object(P.jsxs)("div",{className:"brush-panel__block brush-color",children:[Object(P.jsx)("div",{className:"brush-panel__panel-title",children:"\u0426\u0432\u0435\u0442 \u043a\u0438\u0441\u0442\u0438"}),Object(P.jsxs)("div",{className:"brush-panel__inputs-block",children:[Object(P.jsx)("input",{onChange:function(e){Te.getTool().setColor(e.target.value)},value:ce.toHex(e.brushColor),type:"color"}),Object(P.jsx)("input",{value:ce.toHex(e.brushColor),type:"text"})]})]}),Object(P.jsx)("div",{className:"brush-panel__block",children:Object(P.jsx)("button",{onClick:function(t){Te.saveBrush({color:e.brushColor,alpha:e.brushAlpha,size:e.brushSize})},className:"panel__block-button add-brush-btn",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/plus-icon.svg",alt:""})})}),Object(P.jsx)(We,{})]})}));a(54);var Ke=Object(o.b)((function(e){return{canvasZoom:e.canvas.zoom,top:e.canvas.position.top,left:e.canvas.position.left,canvasSize:e.canvas.size}}),(function(e){return{setCanvasZoom:Object(l.a)(F,e),setCanvasPosition:Object(l.a)(z,e)}}))((function(e){return Object(P.jsxs)("div",{className:"top-panel__setting-hand-tool",children:[Object(P.jsx)("div",{children:Object(P.jsx)(Ye,{title:"\u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435",onChange:function(t){e.setCanvasZoom(t.currentTarget.value)},max:"5",min:"0.1",step:"0.1",value:e.canvasZoom})}),Object(P.jsx)("div",{children:Object(P.jsx)(Ye,{title:"x \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u0430",onChange:function(t){e.setCanvasPosition({top:e.top,left:t.currentTarget.value+"px"})},max:parseInt(e.canvasSize.width),min:-parseInt(e.canvasSize.width),step:"1",value:parseInt(e.left)})}),Object(P.jsx)("div",{children:Object(P.jsx)(Ye,{title:"y \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u0430",onChange:function(t){e.setCanvasPosition({top:t.currentTarget.value+"px",left:e.left})},max:parseInt(e.canvasSize.height),min:-parseInt(e.canvasSize.height),step:"1",value:parseInt(e.top)})}),Object(P.jsx)("div",{className:"top-panel__center-btn",children:Object(P.jsx)("button",{onClick:function(){e.setCanvasPosition({top:"1px",left:"1px"})},children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u043e \u0446\u0435\u043d\u0442\u0440\u0443"})})]})}));a(55);var Ue=Object(o.b)((function(e){return{currentLayout:e.layouts.currentLayout,dragBlockEnabled:e.tool.image.dragBlockEnabled,x:e.tool.image.position.x,y:e.tool.image.position.y,width:e.tool.image.position.width,height:e.tool.image.position.height,canvasHeigth:e.canvas.size.height,canvasWidth:e.canvas.size.width}}),{disableDragBlock:_e,setFile:xe,setPosition:Oe,finish:Ce})((function(e){function t(t){e.setPosition({x:t.currentTarget.value,y:e.y,width:e.width,height:e.height})}function a(t){e.setPosition({x:e.x,y:t.currentTarget.value,width:e.width,height:e.height})}function n(t){e.setPosition({x:e.x,y:e.y,width:t.currentTarget.value,height:e.height})}function s(t){e.setPosition({x:e.x,y:e.y,width:e.width,height:t.currentTarget.value})}return Object(P.jsxs)("div",{children:[e.dragBlockEnabled&&Object(P.jsx)("div",{}),!e.dragBlockEnabled&&Object(P.jsxs)("div",{className:"top-panel__image-tool image-tool",children:[Object(P.jsxs)("div",{className:"image-tool__ block coords",children:[Object(P.jsxs)("div",{className:"image-tool__block-row",children:[Object(P.jsx)("h3",{children:"X"}),Object(P.jsxs)("div",{className:"image-tool__inputs",children:[Object(P.jsx)("input",{type:"number",value:e.x,onChange:t,min:0,max:e.canvasWidth}),Object(P.jsx)("input",{type:"range",value:e.x,onChange:t,min:0,max:e.canvasWidth})]})]}),Object(P.jsxs)("div",{className:"image-tool__block-row",children:[Object(P.jsx)("h3",{children:"Y"}),Object(P.jsxs)("div",{className:"image-tool__inputs",children:[Object(P.jsx)("input",{type:"number",value:e.y,onChange:a,min:0,max:e.canvasHeigth}),Object(P.jsx)("input",{type:"range",value:e.y,onChange:a,min:0,max:e.canvasHeigth})]})]})]}),Object(P.jsxs)("div",{className:"image-tool__ block sizes",children:[Object(P.jsxs)("div",{className:"image-tool__block-row",children:[Object(P.jsx)("h3",{children:"\u0448\u0438\u0440\u0438\u043d\u0430"}),Object(P.jsxs)("div",{className:"image-tool__inputs",children:[Object(P.jsx)("input",{type:"number",value:e.width,onChange:n,min:0,max:e.canvasWidth}),Object(P.jsx)("input",{type:"range",value:e.width,onChange:n,min:0,max:e.canvasWidth})]})]}),Object(P.jsxs)("div",{className:"image-tool__block-row",children:[Object(P.jsx)("h3",{children:"\u0432\u044b\u0441\u043e\u0442\u0430"}),Object(P.jsxs)("div",{className:"image-tool__inputs",children:[Object(P.jsx)("input",{type:"number",value:e.height,onChange:s,min:0,max:e.canvasHeigth}),Object(P.jsx)("input",{type:"range",value:e.height,onChange:s,min:0,max:e.canvasHeigth})]})]})]}),Object(P.jsx)("button",{onClick:function(){e.finish()},children:"\u0412\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435"})]})]})}));var Ze=Object(o.b)((function(e){return{brushSize:e.tool.eraser.size}}),{changeEraserSetting:function(e){return{type:y,payload:{size:e}}}})((function(e){return Object(P.jsx)("div",{children:Object(P.jsx)(Ye,{title:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043b\u0430\u0441\u0442\u0438\u043a\u0430",value:e.brushSize,onChange:function(t){e.changeEraserSetting(t.target.value)},max:"250",min:"0",step:"1"})})}));var Ve=Object(o.b)((function(e){return{currentToolName:e.canvas.currentToolName}}))((function(e){switch(e.currentToolName){case"HAND":return Object(P.jsx)(Ke,{});case"ERASER":return Object(P.jsx)(Ze,{});case"IMAGE":return Object(P.jsx)(Ue,{});case"DRAG":return Object(P.jsx)("div",{});default:return Object(P.jsx)(Xe,{})}}));a(56);var Je=function(e){return Object(P.jsx)("div",{className:"left-panel",children:e.children})};a(57);var qe=Object(o.b)((function(e){return{currentToolName:e.canvas.currentToolName}}))((function(e){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{onClick:function(){Te.setTool(Te.SKETCH_BRUSH)},className:e.currentToolName===Te.SKETCH_BRUSH?"left-panel__tool-item active":"left-panel__tool-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/brush.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(){Te.setTool(Te.ERASER)},className:e.currentToolName===Te.ERASER?"left-panel__tool-item active":"left-panel__tool-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/eraser.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(){Te.setTool(Te.HAND)},className:e.currentToolName===Te.HAND?"left-panel__tool-item active":"left-panel__tool-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/hand.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(){Te.setTool(Te.DRAG)},className:e.currentToolName===Te.DRAG?"left-panel__tool-item active":"left-panel__tool-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/selection.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(){Te.setTool(Te.IMAGE)},className:e.currentToolName===Te.IMAGE?"left-panel__tool-item active":"left-panel__tool-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/picture.svg",alt:""})})]})}));a(58);var Qe=function(e){return Object(P.jsx)("div",{className:"right-panel",children:e.children})},$e=a(8);a(59),a(60);var et,tt=Object(o.b)((function(e){return{defaultBackgorund:e.setting.canvasDefaultBackground}}))((function(e){var t=e.layout,a=t.getCanvas(),s=Object(n.useRef)(),i=e.index;return Object(n.useEffect)((function(){return s.current.append(a),a.style.backgroundColor=e.defaultBackgorund,a.style.outline=e.isCurrent?"10px solid red":"none",function(){return a.remove()}})),Object(P.jsxs)("div",{onContextMenu:function(a){if(t.isSelected()){e.setMenuActive(!0);var n=a.pageY-10,s=a.pageX-20;s+200>=window.innerWidth&&(s=window.innerWidth-200),n+200>=window.innerHeight&&(n=window.innerHeight-200),e.setMenuPosition({x:n,y:s})}a.stopPropagation(),a.preventDefault()},ref:s,onClick:function(e){e.ctrlKey?fe.select(i):(fe.setCurrentLayout(i),e.stopPropagation())},style:e.isSelected?{backgroundColor:"darkred"}:{backgroundColor:"black"},className:"right-panel__layout-block layout-block",children:[Object(P.jsxs)("div",{className:"layout-block__left-menu",children:[Object(P.jsx)("div",{onClick:function(e){fe.swap(i,i-1),e.stopPropagation()},className:"layout-block__left-menu-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/up.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(e){fe.toggleHide(i),e.stopPropagation()},className:"layout-block__left-menu-item",children:e.isHidden?Object(P.jsx)("img",{src:"./img/hide.svg",alt:""}):Object(P.jsx)("img",{src:"/React-Multiplicate/img/show.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(e){fe.deleteLayout(i),e.stopPropagation()},className:"layout-block__left-menu-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/delete.svg",alt:""})}),Object(P.jsx)("div",{onClick:function(e){fe.swap(i,i+1),e.stopPropagation()},className:"layout-block__left-menu-item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/up.svg",alt:"",style:{transform:"rotateX(180deg)"}})})]}),Object(P.jsxs)("div",{className:"layout-block__bottom-menu",children:[Object(P.jsx)("div",{className:"layout-block__bottom-menu-item history",children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f"}),Object(P.jsx)("div",{onClick:function(e){t.historyBack(),fe.update(),e.stopPropagation()},className:"layout-block__bottom-menu-item back",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/up.svg",alt:"",style:{transform:"rotateZ(-90deg)"}})}),Object(P.jsx)("div",{onClick:function(e){t.historyNext(),fe.update(),e.stopPropagation()},className:"layout-block__bottom-menu-item next",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/up.svg",alt:"",style:{transform:"rotateZ(90deg)"}})})]})]},i)}));a(61);var at=function(e){var t=Object(n.useState)("context-menu disabled"),a=Object($e.a)(t,2),s=a[0],i=a[1];return Object(n.useEffect)((function(){e.active?(i("context-menu"),setTimeout((function(){i("context-menu active")}),300)):i("context-menu disabled")}),[e.active]),Object(P.jsx)("div",{className:s,onMouseLeave:function(){i("context-menu"),et=setTimeout((function(){console.log("timeout end"),e.setMenuActive(!1)}),300)},onMouseEnter:function(){clearTimeout(et),i("context-menu active")},style:{top:e.menuPosition.x,left:e.menuPosition.y},children:e.children})};var nt=Object(o.b)((function(e){return{layoutList:e.layouts.layoutList,currentLayoutIndex:e.layouts.currentLayoutIndex,canvas:e.canvas.canvas,context:e.canvas.context}}))((function(e){var t=Object(n.useState)({x:0,y:0}),a=Object($e.a)(t,2),s=a[0],i=a[1],r=Object(n.useState)(!1),o=Object($e.a)(r,2),l=o[0],u=o[1],h=Object(P.jsxs)(at,{setMenuActive:u,active:l,menuPosition:s,children:[Object(P.jsx)("div",{onClick:function(){fe.copyLayouts()},className:"context-menu-item",children:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(P.jsx)("div",{onClick:function(t){u(!1);var a=[];console.log(e.layoutList),e.layoutList.map((function(e,t){return e.isSelected()&&a.push(t),e})),fe.deleteSelectedLayouts(a)},className:"context-menu-item",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),Object(P.jsx)("div",{onClick:function(e){fe.combineSelected(),u(!1)},className:"context-menu-item",children:"\u041e\u0431\u044c\u0435\u0434\u0435\u043d\u0438\u0442\u044c"}),Object(P.jsx)("div",{onClick:function(){fe.unSelectAll()},className:"context-menu-item",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435"})]});return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{className:"right-panel__layout-buttons",children:[Object(P.jsx)("button",{onClick:function(){var t=new ve(e.canvas,e.context,!0,++fe.id);fe.addLayout(t)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0439"}),Object(P.jsx)("button",{onClick:function(t){var a=new ve(e.canvas,e.context,!0,++fe.id);De.addFrame(a,100)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u0430\u0434\u0440\u044b"})]}),c.a.createPortal(h,document.getElementById("root")),Object(P.jsx)("div",{className:"right-panel__layout-list",children:e.layoutList.map((function(t,a){return Object(P.jsx)(tt,{layout:t,index:a,isCurrent:a===e.currentLayoutIndex,isHidden:t.isHidden(),isSelected:t.isSelected(),setMenuPosition:i,setMenuActive:u},t.getId())}))})]})}));a(62),a(63);var st=Object(o.b)((function(e){return{currentFrameIndex:e.frames.currentFrameIndex,defaultBackgorund:e.setting.canvasDefaultBackground,layoutList:e.layouts.layoutList}}))((function(e){var t=e.value,a=t.getId(),i=e.index,c=s.a.createRef();Object(n.useEffect)((function(){return e.isOpen&&(c.current.prepend(t.getCanvas()),t.getCanvas().style.backgroundColor=e.defaultBackgorund),function(){t.getCanvas().remove()}}),[a,e.defaultBackgorund,t,e.isOpen,c]);var r=e.isOpen?"frame-block opened":"frame-block";return r=e.isSelected?r+" selected":r,Object(P.jsxs)("div",{ref:c,className:r,style:e.currentFrameIndex===i?{background:"darkred"}:{},onClick:function(a){if(a.ctrlKey)return e.isSelected?t.unSelect():t.select(),De.changeFrame(),void a.stopPropagation();De.set\u0421urrentFrameIndex(i)},onContextMenu:function(t){if(e.isSelected){var a=t.pageY-10,n=t.pageX-20;n+200>=window.innerWidth&&(n=window.innerWidth-200),a+200>=window.innerHeight&&(a=window.innerHeight-200),e.setMenuPosition({x:a,y:n}),e.setMenuActive(!0)}t.preventDefault(),t.stopPropagation()},children:[Object(P.jsx)("span",{className:"frame-block__index",children:e.index+1}),Object(P.jsx)("div",{className:"frame-block__open-close-btn",onClick:function(e){De.openCloseFrame(t),e.stopPropagation()}}),Object(P.jsxs)("div",{className:"frame-block__menu frame-menu",children:[Object(P.jsx)("div",{onClickCapture:function(e){De.swap(i,i-1),e.stopPropagation()},className:"frame-menu__item",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/up.svg",alt:""})}),Object(P.jsx)("div",{className:"frame-menu__item",children:Object(P.jsx)("button",{onClickCapture:function(a){var n=document.createElement("canvas");n.width=t.getCanvas().width,n.height=t.getCanvas().height;var s=n.getContext("2d");s.drawImage(t.getCanvas(),0,0);var i=new ve(n,s,!0,++fe.id);e.layoutList.push(i),fe.changeLayoutList(e.layoutList),a.stopPropagation()},children:"\u0412 \u0441\u043b\u043e\u0438"})}),Object(P.jsx)("div",{onClickCapture:function(e){De.swap(i,i+1),e.stopPropagation()},className:"frame-menu__item down-arrow",children:Object(P.jsx)("img",{src:"/React-Multiplicate/img/up.svg",alt:""})})]}),Object(P.jsxs)("div",{className:"frame-block__input-block",children:[Object(P.jsx)("h2",{children:"\u0417\u0430\u0434\u0435\u0440\u0436\u043a\u0430"}),Object(P.jsx)("input",{onClickCapture:function(e){return e.stopPropagation()},value:t.getDelay(),onChange:function(e){var a=e.currentTarget.value;t.setDelay(a),De.changeFrame(i,t),e.stopPropagation()},min:"0",type:"number"})]}),Object(P.jsx)("div",{className:"frame-block__delete-btn",children:Object(P.jsx)("img",{onClickCapture:function(e){De.deleteFrame(i),e.stopPropagation()},src:"/React-Multiplicate/img/delete.svg",alt:""})})]})}));a(64);var it=Object(o.b)((function(e){return{frameList:e.frames.frameList}}))((function(e){var t=Object(n.useState)(!1),a=Object($e.a)(t,2),s=a[0],i=a[1],r=Object(n.useState)({x:"0px",y:"0px"}),o=Object($e.a)(r,2),l=o[0],u=o[1],h=Object(n.useState)(100),d=Object($e.a)(h,2),v=d[0],f=d[1],m=Object(P.jsxs)(at,{active:s,setMenuActive:i,menuPosition:l,children:[Object(P.jsxs)("div",{className:"context-menu-item",children:[Object(P.jsx)("div",{children:"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0443"}),Object(P.jsxs)("div",{children:[Object(P.jsx)("input",{className:"context-menu-item__input",value:v,onChange:function(e){f(e.currentTarget.value)},type:"number"}),Object(P.jsx)("button",{onClick:function(e){i(!1),De.setDelaySelectedFrames(v)},children:"OK"})]})]}),Object(P.jsx)("div",{className:"context-menu-item",onClick:function(){i(!1),window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u043a\u0430\u0434\u0440\u044b ?")&&De.deleteSelectedFrame()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),Object(P.jsx)("div",{className:"context-menu-item",onClick:function(){De.unSelectAllFrame()},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435"})]});return Object(P.jsxs)("div",{className:"right-panel__frames",children:[c.a.createPortal(Object(P.jsx)(P.Fragment,{children:m}),document.getElementById("root")),e.frameList.map((function(e,t){return Object(P.jsx)(st,{value:e,index:t,delay:e.getDelay(),isOpen:e.isOpen(),isSelected:e.isSelected(),setMenuActive:i,setMenuPosition:u},e.getId())}))]})}));function ct(e){var t=Object(n.useState)(0),a=Object($e.a)(t,2),s=a[0],i=a[1],c=e.setContent;return Object(n.useEffect)((function(){switch(s){case 0:c(Object(P.jsx)(nt,{}));break;case 1:c("history");break;case 2:c(Object(P.jsx)(it,{}))}}),[s,c]),Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"right-panel__tabs",children:[Object(P.jsx)("button",{onClick:function(){i(0)},className:0===s?"right-panel__tabs-button active":"right-panel__tabs-button",children:"\u0421\u043b\u043e\u0438"}),Object(P.jsx)("button",{onClick:function(){i(2)},className:2===s?"right-panel__tabs-button active":"right-panel__tabs-button",children:"\u041a\u0430\u0434\u0440\u044b"})]})})}var rt=Object(o.b)()((function(){var e=Object(n.useState)(Object(P.jsx)(nt,{})),t=Object($e.a)(e,2),a=t[0],s=t[1];return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(ct,{setContent:s}),a]})}));a(65);var ot=function(e){return Object(P.jsx)("div",{className:"center-space",children:e.children})};function lt(){return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)(ze,{children:[Object(P.jsx)(Ge,{}),Object(P.jsx)(Ve,{})]}),Object(P.jsx)(Je,{children:Object(P.jsx)(qe,{})}),Object(P.jsx)(Qe,{children:Object(P.jsx)(rt,{})}),Object(P.jsx)(ot,{children:Object(P.jsx)(He,{})})]})}a(66),a(67);var ut=function(e){return Object(P.jsxs)("div",{className:"top-panel__save-tabs save-tabs",children:[Object(P.jsx)(Pe.b,{to:"/save/gif",className:"save-tabs__item",children:"Gif"}),Object(P.jsx)(Pe.b,{to:"/save/jpg",className:"save-tabs__item",children:"Jpg"}),Object(P.jsx)(Pe.b,{to:"/save/png",className:"save-tabs__item",children:"Png"})]})},ht=(a(68),a(29)),dt=a.n(ht),vt=(a(69),a.p+"static/media/preloader.279ed7ee.gif");var ft=function(e){return Object(P.jsxs)("div",{className:"preloader",children:[Object(P.jsx)("h2",{children:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}),Object(P.jsx)("img",{className:"preloader__img",src:vt,alt:""})]})};var mt=Object(o.b)((function(e){return{frameList:e.frames.frameList,width:parseInt(e.canvas.size.width),height:parseInt(e.canvas.size.height)}}))((function(e){var t=Object(n.useState)(0),a=Object($e.a)(t,2),s=a[0],i=a[1],c=Object(n.useState)(10),r=Object($e.a)(c,2),o=r[0],l=r[1],u=Object(n.useState)(e.width),h=Object($e.a)(u,2),d=h[0],v=h[1],f=Object(n.useState)(e.height),m=Object($e.a)(f,2),p=m[0],j=m[1],g=Object(n.useState)("#ffffff"),b=Object($e.a)(g,2),y=b[0],_=b[1],x=Object(n.useState)(!1),O=Object($e.a)(x,2),C=O[0],k=O[1],L=Object(n.useState)(!0),w=Object($e.a)(L,2),S=w[0],N=w[1];return Object(P.jsxs)("div",{className:"save-gif-panel",children:[Object(P.jsxs)("div",{className:"save-gif-panel__row",children:[Object(P.jsxs)("div",{className:"save-gif-panel__item",children:[Object(P.jsx)("h4",{children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439 \u0434\u043b\u044f gif. \u0415\u0441\u043b\u0438 -1, \u0442\u043e \u0431\u0435\u0437 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439. \u0415\u0441\u043b\u0438 0 - \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0442\u044c \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u043e "}),Object(P.jsx)(Ye,{title:"\u041f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u044f",max:"1000",min:"-1",step:"1",value:s,onChange:function(e){return i(e.currentTarget.value)}})]}),Object(P.jsxs)("div",{className:"save-gif-panel__item",children:[Object(P.jsx)("h4",{children:"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043f\u0438\u043a\u0441\u0435\u043b\u0435\u0439. \u0427\u0435\u043c \u043c\u0435\u043d\u044c\u0448\u0435, \u0442\u0435\u043c \u043b\u0443\u0447\u0448\u0435"}),Object(P.jsx)(Ye,{title:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e",max:"100",min:"1",step:"1",value:o,onChange:function(e){return l(e.currentTarget.value)}})]})]}),Object(P.jsxs)("div",{className:"save-gif-panel__row",children:[Object(P.jsxs)("div",{className:"save-gif-panel__size",children:[Object(P.jsxs)("div",{className:"save-gif-panel__item",children:[Object(P.jsx)("span",{children:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438"}),Object(P.jsx)("input",{type:"checkbox",checked:S,onChange:function(e){N(e.currentTarget.checked)}})]}),Object(P.jsx)("div",{className:"save-gif-panel__item",children:Object(P.jsx)(Ye,{title:"\u0428\u0438\u0440\u0438\u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",max:"2000",min:"0",step:"1",value:d,onChange:function(t){v(t.currentTarget.value),S&&j(t.currentTarget.value*e.height/e.width)}})}),Object(P.jsx)("div",{className:"save-gif-panel__item",children:Object(P.jsx)(Ye,{title:"\u0412\u044b\u0441\u043e\u0442\u0430",max:"2000",min:"0",step:"1",value:p,onChange:function(t){j(t.currentTarget.value),S&&v(t.currentTarget.value*e.width/e.height)}})})]}),Object(P.jsxs)("div",{className:"save-gif-panel__color",children:[Object(P.jsx)("h4",{children:"\u0426\u0432\u0435\u0442 \u0444\u043e\u043d\u0430"}),Object(P.jsx)("input",{className:"save-gif-panel__color-input",type:"color",value:y,onChange:function(e){_(e.currentTarget.value)}})]})]}),Object(P.jsx)("div",{className:"save-gif-panel__row",children:Object(P.jsx)("div",{className:"save-gif-panel__save-btn-wrapper",children:C?Object(P.jsx)(ft,{}):Object(P.jsx)("button",{className:"save-gif-panel__save-btn",onClick:function(){var t=e.frameList;if(0!==t.length){k(!0);var a=new dt.a({workers:2,quality:o,repeat:s});setTimeout((function(){t.forEach((function(e,t){var n=document.createElement("canvas");n.width=d,n.height=p;var s=n.getContext("2d");s.fillStyle=y,s.fillRect(0,0,d,p),s.drawImage(e.getCanvas(),0,0,d,p),a.addFrame(n,{delay:e.getDelay(),copy:!0})})),a.on("finished",(function(e){k(!1),window.open(URL.createObjectURL(e))})),a.render()}),0)}else alert("\u0421\u043f\u0438\u0441\u043e\u043a \u0444\u0440\u0435\u0439\u043c\u043e\u0432 \u043f\u0443\u0441\u0442 !")},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c !"})})})]})}));var pt=function(e){return Object(P.jsxs)("div",{className:"save-window",children:[Object(P.jsxs)(ze,{children:[Object(P.jsx)(Ge,{}),Object(P.jsx)(ut,{})]}),Object(P.jsx)(Je,{}),Object(P.jsx)(Qe,{}),Object(P.jsxs)(ot,{children:[Object(P.jsx)(Fe.b,{path:"/save/gif",children:Object(P.jsx)(mt,{})}),Object(P.jsx)(Fe.b,{path:"/save/jpg",children:Object(P.jsx)("div",{children:"JPG"})}),Object(P.jsx)(Fe.b,{path:"/save/png",children:Object(P.jsx)("div",{children:"PNG"})}),Object(P.jsx)(Fe.b,{exact:!0,path:"/save",children:Object(P.jsx)("div",{className:"save-window__file-type-title",children:Object(P.jsx)("h1",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u0430"})})})]})]})};var jt=Object(o.b)((function(e){return{drawCanvas:e.canvas.canvas,frameList:e.frames.frameList,currentFrameIndex:e.frames.currentFrameIndex}}))((function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){return De.setMultiplicateCanvas(t.current),function(){De.pause()}}),[]),Object(n.useEffect)((function(){if(0!==e.frameList.length){var a=t.current.getContext("2d");!function t(){if(!e.frameList[e.currentFrameIndex])return;a.clearRect(0,0,e.drawCanvas.width,e.drawCanvas.height),a.drawImage(e.frameList[e.currentFrameIndex].getCanvas(),0,0),requestAnimationFrame(t)}()}})),Object(P.jsx)(P.Fragment,{children:Object(P.jsx)("canvas",{ref:t,width:e.drawCanvas.width,height:e.drawCanvas.height})})}));function gt(){var e=Object(n.useState)(100),t=Object($e.a)(e,2),a=t[0],s=t[1];return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{children:[Object(P.jsx)("h3",{children:"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0443 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0441\u043b\u043e\u0435\u0432"}),Object(P.jsx)("input",{type:"number",value:a,onChange:function(e){s(e.currentTarget.value)}}),Object(P.jsx)("button",{onClick:function(){De.setDelayToAll(a)},children:"OK"})]}),Object(P.jsx)(it,{})]})}a(70);var bt=Object(o.b)(null,{canPlay:function(){return{type:L}}})((function(e){return Object(P.jsxs)("div",{className:"top-panel-buttons",children:[Object(P.jsx)("button",{className:"pause-button",onClick:function(){De.pause()}}),Object(P.jsx)("button",{className:"play-button",onClick:function(){e.canPlay(),De.playFilm()}})]})}));a(71);var yt=Object(o.b)((function(e){return{currentFrameIndex:e.frames.currentFrameIndex,frameList:e.frames.frameList}}))((function(e){return Object(P.jsx)("div",{className:"top-panel-inputs-block",children:Object(P.jsx)(Ye,{title:"\u0424\u0440\u044d\u0439\u043c\u044b",onChange:function(e){De.set\u0421urrentFrameIndex(+e.target.value)},value:e.currentFrameIndex,min:"0",max:e.frameList.length-1,step:"1"})})}));a(72);function _t(){return Object(P.jsx)(P.Fragment,{children:Object(P.jsxs)("div",{className:"top-panel-content",children:[Object(P.jsx)(bt,{}),Object(P.jsx)(yt,{})]})})}var xt=Object(o.b)((function(e){return{canvas:e.canvas.canvas}}))((function(e){return e.canvas?Object(P.jsxs)("div",{children:[Object(P.jsxs)(ze,{children:[Object(P.jsx)(Ge,{}),Object(P.jsx)(_t,{})]}),Object(P.jsx)(Qe,{children:Object(P.jsx)(gt,{})}),Object(P.jsx)(ot,{children:Object(P.jsx)(jt,{})}),Object(P.jsx)(Je,{})]}):Object(P.jsx)(Fe.a,{to:"/draw"})}));var Ot=Object(o.b)()((function(){return Object(P.jsx)(Pe.a,{children:Object(P.jsx)("div",{className:"main",children:Object(P.jsxs)(Fe.d,{children:[Object(P.jsx)(Fe.b,{path:"/draw",render:function(){return Object(P.jsx)(lt,{})}}),Object(P.jsx)(Fe.b,{path:"/frames",render:function(){return Object(P.jsx)(xt,{})}}),Object(P.jsx)(Fe.b,{path:"/save",render:function(){return Object(P.jsx)(pt,{})}}),Object(P.jsx)(Fe.a,{from:"/",to:"/draw"})]})})})}));c.a.render(Object(P.jsx)(s.a.StrictMode,{children:Object(P.jsx)(o.a,{store:se,children:Object(P.jsx)(Ot,{})})}),document.getElementById("root")),r()}]),[[73,1,2]]]);
//# sourceMappingURL=main.a52c718f.chunk.js.map
(this["webpackJsonpReact-Multiplicate"]=this["webpackJsonpReact-Multiplicate"]||[]).push([[0],Array(33).concat([function(e,t,a){},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(15),r=a.n(c),i=(a(33),function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,70)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))}),o=a(3),l=(a(39),a(13)),u=(a(40),"CHANGE_CANVAS_SIZE"),d="SET_CANVAS",h="CHANGE_CURRENT_TOOL",v="SET_CANVAS_BLOCK",f="SET_CANVAS_POSITION",j="SET_CANVAS_ZOOM",b="CHANGE_BRUSH_SETTING",m="SAVE_BRUSH",p="CHANGE_CANVAS_DEFAULT_BACKGROUND",g="CHANGE_SAVED_BRUSHES",y="CHANGE_LAYOUT_LIST",x="CHANGE_CURRENT_LAYOUT",O="CHANGE_FRAME_LIST",_="SET_MULTIPLICATE_CANVAS",C="STOP_PLAY",k="CAN_PLAY",L="SET_CURRENT_FRAME";function S(e,t){return{type:u,payload:{width:e,height:t}}}function N(e,t){return{type:d,payload:{canvas:e,context:t}}}function w(e,t){return{type:h,payload:{currentTool:e,currentToolName:t}}}function I(e){return{type:v,payload:e}}function T(e){return{type:f,payload:e}}function A(e){return{type:j,payload:e}}var E=a(2),H={canvas:null,canvasBlock:null,context:null,size:{width:"100px",height:"100px"},position:{top:"1px",left:"1px"},currentTool:null,currentToolName:"",zoom:1};var B={color:"#ff0f00",size:"20",alpha:1,savedBrushes:[],activeTool:"SCETCH_BRUSH"};var F={canvasDefaultBackground:"#ececec"};var R={layoutList:[],currentLayout:null,currentLayoutIndex:0,changeCurrentCanvas:!0};var z={frameList:[],frameCanvas:null,stopPlay:!0,currentFrameIndex:0};var P=Object(l.b)({canvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return Object(E.a)(Object(E.a)({},e),{},{size:{width:t.payload.width,height:t.payload.height}});case d:return Object(E.a)(Object(E.a)({},e),{},{canvas:t.payload.canvas,context:t.payload.context});case h:return Object(E.a)(Object(E.a)({},e),{},{currentTool:t.payload.currentTool,currentToolName:t.payload.currentToolName});case v:return Object(E.a)(Object(E.a)({},e),{},{canvasBlock:t.payload});case f:return Object(E.a)(Object(E.a)({},e),{},{position:t.payload});case j:return Object(E.a)(Object(E.a)({},e),{},{zoom:t.payload});default:return e}},brush:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(E.a)(Object(E.a)({},e),t.payload);case m:return Object(E.a)(Object(E.a)({},e),{},{savedBrushes:e.savedBrushes.concat(t.payload)});case g:return Object(E.a)(Object(E.a)({},e),{},{savedBrushes:Array.from(t.payload)});default:return e}},setting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p:return Object(E.a)({},e);default:return e}},layouts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(E.a)(Object(E.a)({},e),{},{layoutList:Array.from(t.payload)});case x:return Object(E.a)(Object(E.a)({},e),{},{currentLayout:t.payload.currentLayout,currentLayoutIndex:t.payload.currentLayoutIndex,changeCurrentCanvas:!e.changeCurrentCanvas});default:return e}},frames:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(E.a)(Object(E.a)({},e),{},{frameList:t.payload.frameList.concat()});case _:return Object(E.a)(Object(E.a)({},e),{},{frameCanvas:t.payload});case C:return Object(E.a)(Object(E.a)({},e),{},{stopPlay:!0});case k:return Object(E.a)(Object(E.a)({},e),{},{stopPlay:!1});case L:return Object(E.a)(Object(E.a)({},e),{},{currentFrameIndex:t.payload});default:return e}}}),M=Object(l.c)(P),D=(a(41),a(6)),U=a(7);function W(e){return{type:O,payload:{frameList:e}}}function G(){return{type:C}}function Y(e){return{type:L,payload:e}}var Z=function(){function e(t,a,n){Object(D.a)(this,e),this._canvas=t,this._delay=a,this._id=n,this._type="Frame",this._open=!1,this._isSelect=!1}return Object(U.a)(e,[{key:"getCanvas",value:function(){return this._canvas}},{key:"setDelay",value:function(e){this._delay=e}},{key:"getDelay",value:function(){return this._delay}},{key:"setId",value:function(e){this._id=e}},{key:"getId",value:function(){return this._id}},{key:"isOpen",value:function(){return this._open}},{key:"open",value:function(){this._open=!0}},{key:"close",value:function(){this._open=!1}},{key:"select",value:function(){this._isSelect=!0}},{key:"unSelect",value:function(){this._isSelect=!1}},{key:"isSelected",value:function(){return this._isSelect}}]),e}(),V=function(){function e(){Object(D.a)(this,e)}return Object(U.a)(e,null,[{key:"addFrame",value:function(e,t){var a=M.getState();if(a.frames.stopPlay){var n=document.createElement("canvas"),s=a.frames.currentFrameIndex,c=a.frames.frameList;n.width=e.getCanvas().width,n.height=e.getCanvas().height,n.getContext("2d").drawImage(e.getCanvas(),0,0);var r=new Z(n,t,this.id++);c.push(r),M.dispatch(W(c)),-1===s&&M.dispatch(Y(0))}}},{key:"setDelaySelectedFrames",value:function(e){var t=M.getState().frames.frameList;t.forEach((function(t,a){t.isSelected()&&t.setDelay(e)})),M.dispatch(W(t))}},{key:"deleteSelectedFrame",value:function(){var e=M.getState().frames.frameList.filter((function(e,t){return!e.isSelected()}));console.log(e),M.dispatch(W(e)),M.dispatch(Y(e.length-1))}},{key:"unSelectAllFrame",value:function(){var e=M.getState().frames.frameList;e.forEach((function(e,t){e.isSelected()&&e.unSelect()})),M.dispatch(W(e))}},{key:"changeFrame",value:function(){console.log("ok wce good");var e=M.getState(),t=(e.frames.stopPlay,e.frames.frameList);M.dispatch(W(t))}},{key:"deleteFrame",value:function(e){var t=M.getState();if(t.frames.stopPlay){var a=t.frames.frameList,n=t.frames.currentFrameIndex;a.splice(e,1),a.length-1<n&&M.dispatch(Y(a.length-1)),M.dispatch(W(a))}}},{key:"openCloseFrame",value:function(e){e.isOpen()?e.close():e.open();var t=M.getState().frames.frameList;M.dispatch(W(t))}},{key:"swap",value:function(e,t){var a=M.getState();if(a.frames.stopPlay){var n=a.frames.frameList;if(!(e<0||e>n.length-1||t<0||t>n.length-1)){var s=n[e];n[e]=n[t],n[t]=s,M.dispatch(W(n))}}}},{key:"playFilm",value:function(){var e=this;console.log("playFilm");var t=M.getState(),a=t.frames.frameList;if(0!==a.length||0!==a.length){var n=t.frames.currentFrameIndex,s=a[n];s.getDelay(),setTimeout((function(){var t=M.getState(),s=t.frames.stopPlay;n=t.frames.currentFrameIndex,s||(a.length-1!=n?(M.dispatch(Y(++n)),e.playFilm()):e.pause())}),s.getDelay())}else alert("\u0421\u043f\u0438\u0441\u043e\u043a \u0444\u0440\u0435\u0439\u043c\u043e\u0432 \u043f\u0443\u0441\u0442 !")}},{key:"pause",value:function(){M.dispatch(G())}},{key:"stop",value:function(){M.dispatch(G()),Y(0)}},{key:"set\u0421urrentFrameIndex",value:function(e){M.dispatch(Y(e))}},{key:"setMultiplicateCanvas",value:function(e){M.dispatch(function(e){return{type:_,payload:{canvas:e,context:e.getContext("2d")}}}(e))}},{key:"setDelayToAll",value:function(e){var t=M.getState().frames.frameList;t.map((function(t,a){t.setDelay(e)})),M.dispatch(W(t))}}]),e}();V.id=0;var K=a(28);function X(e){return{type:y,payload:e}}function J(e,t){return{type:x,payload:{currentLayout:e,currentLayoutIndex:t}}}var q=function(){function e(t,a,n,s){Object(D.a)(this,e),this._canvas=t,this._ctx=a,this._show=n,this._name=null,this._historyArr=[],this._positionInHistory=-1,this.saveInHistory(),this.selected=!1,this.id=s}return Object(U.a)(e,[{key:"getId",value:function(){return this.id}},{key:"toggleHide",value:function(){this._show?this._show=!1:this._show=!0}},{key:"isHidden",value:function(){return!this._show}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getContext",value:function(){return this._ctx}},{key:"clear",value:function(){this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._historyArr=[]}},{key:"saveInHistory",value:function(){this._positionInHistory!==this._historyArr.length-1&&(this._historyArr=this._historyArr.slice(0,this._positionInHistory+1)),this._historyArr.length>40&&this._historyArr.shift(),this._historyArr.push(this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)),this._positionInHistory=this._historyArr.length-1}},{key:"historyBack",value:function(){0!==this._positionInHistory&&(this._positionInHistory-=1,this._ctx.putImageData(this._historyArr[this._positionInHistory],0,0),Q.update())}},{key:"historyNext",value:function(){this._positionInHistory!==this._historyArr.length-1&&(this._positionInHistory+=1,this._ctx.putImageData(this._historyArr[this._positionInHistory],0,0),Q.update())}},{key:"select",value:function(){this.selected=!this.selected}},{key:"isSelected",value:function(){return this.selected}}]),e}(),Q=function(){function e(){Object(D.a)(this,e)}return Object(U.a)(e,null,[{key:"init",value:function(){var t=M.getState(),a=t.canvas.canvas,n=t.canvas.context,s=t.layouts.layoutList,c=t.layouts.currentLayoutIndex;if(0==s.length){var r=document.createElement("canvas");r.width=t.canvas.size.width,r.height=t.canvas.size.height;var i=r.getContext("2d");i.putImageData(n.createImageData(a.width,a.height),0,0);var o=new q(r,i,!0,++e.id);s.push(o),M.dispatch(X(s)),M.dispatch(J(o,c))}this.update(),M.dispatch(X(t.layouts.layoutList))}},{key:"update",value:function(){var e=M.getState(),t=e.layouts.layoutList,a=e.canvas.context;a.clearRect(0,0,e.canvas.size.width,e.canvas.size.height);for(var n=0;n<t.length;n++)t[n].isHidden()||a.drawImage(t[n].getCanvas(),0,0)}},{key:"changeLayoutList",value:function(e){M.dispatch(X(e)),this.update()}},{key:"addLayout",value:function(){var t=M.getState(),a=t.layouts.layoutList,n=document.createElement("canvas");n.width=t.canvas.size.width,n.height=t.canvas.size.height;var s=n.getContext("2d"),c=new q(n,s,!0,++e.id);a.splice(t.layouts.currentLayoutIndex+1,0,c),M.dispatch(J(c,t.layouts.currentLayoutIndex+1)),M.dispatch(X(a))}},{key:"copyLayout",value:function(t){var a=M.getState(),n=a.layouts.layoutList,s=document.createElement("canvas");s.width=a.canvas.size.width,s.height=a.canvas.size.height;var c=s.getContext("2d");c.drawImage(a.layouts.layoutList[t].getCanvas(),0,0);var r=new q(s,c,!0,++e.id);n.splice(t+1,0,r),a.layouts.currentLayoutIndex>t?this.setCurrentLayout(a.layouts.currentLayoutIndex+1):this.update()}},{key:"getCanvasList",value:function(){for(var e=M.getState().layouts.layoutList,t=[],a=0;a<e.length;a++){var n=document.createElement("img"),s=e[a].getCanvas().toDataURL();n.setAttribute("src",s),n.setAttribute("data-index",a);var c={src:s,dataIndex:a,id:a,isCurrent:a===this.getCurrentLayoutIndex(),isHidden:this.isHidden(a),selected:e[a].isSelected()};t.push(c)}return t}},{key:"getCurrentLayout",value:function(){return M.getState().layouts.currentLayout}},{key:"setCurrentLayout",value:function(e){e<0&&(e=0);var t=M.getState().layouts.layoutList[e];M.dispatch(J(t,e))}},{key:"getCurrentLayoutIndex",value:function(){return+M.getState().layouts.currentLayoutIndex}},{key:"toggleHide",value:function(e){var t=M.getState();e=+e,t.layouts.layoutList[e].toggleHide(),M.dispatch(X(t.layouts.layoutList)),this.update()}},{key:"deleteLayout",value:function(e){var t=M.getState(),a=t.layouts.layoutList,n=t.layouts.currentLayout,s=t.layouts.currentLayoutIndex;if(a.length<=1)return n.clear(),this.update(),void this.setCurrentLayout(s);a.splice(e,1),s>=e?this.setCurrentLayout(s-1):this.setCurrentLayout(s),this.update(),M.dispatch(X(t.layouts.layoutList))}},{key:"deleteLayouts",value:function(e){var t=M.getState(),a=t.layouts.layoutList,n=t.layouts.currentLayout,s=t.layouts.currentLayoutIndex;return a.length<=1?(n.clear(),this.update(),void M.dispatch(X(a))):(a=a.filter((function(t,a,n){return!e.includes(a)})),M.dispatch(X(a)),0==a.length?(this.addLayout(),this.setCurrentLayout(0),void this.update()):(s>=a.length-1?this.setCurrentLayout(a.length-1):this.setCurrentLayout(s),void this.update()))}},{key:"swap",value:function(e,t){var a=M.getState(),n=a.layouts.layoutList,s=a.layouts.currentLayoutIndex;if(!(e<0||e>n.length-1||t<0||t>n.length-1)){var c=n[e];n[e]=n[t],n[t]=c,e==s?this.setCurrentLayout(t):t==s?this.setCurrentLayout(e):this.setCurrentLayout(s),this.update(),M.dispatch(X(a.layouts.layoutList))}}},{key:"combine",value:function(e){for(var t=M.getState(),a=t.layouts.layoutList,n=(t.layouts.currentLayoutIndex,a[Math.min.apply(Math,Object(K.a)(e))]),s=1;s<e.length;s++){var c=a[e[s]];n.getContext().drawImage(c.getCanvas(),0,0)}n.saveInHistory(),M.dispatch(X(a)),this.deleteLayouts(e.slice(1))}},{key:"getLayoutList",value:function(){return M.getState().layouts.layoutList}},{key:"setLayout",value:function(e,t){M.getState().layouts.layoutList[t]=e,this.update()}},{key:"select",value:function(e){var t=M.getState().layouts.layoutList;t[e].select(),M.dispatch(X(t)),this.update()}},{key:"unSelectAll",value:function(){var e=M.getState().layouts.layoutList;e.forEach((function(e){e.isSelected()&&e.select()})),M.dispatch(X(e)),this.update()}}]),e}();Q.id=0;var $=a(0);var ee=Object(o.b)((function(e){return{width:e.canvas.size.width,height:e.canvas.size.height,top:e.canvas.position.top,left:e.canvas.position.left,tmpCanvas:e.canvas.tmpCanvas,canvasZoom:e.canvas.zoom}}),(function(e){return{setCanvas:Object(l.a)(N,e)}}))((function(e){var t=s.a.createRef();function a(e){if("KeyS"===e.code&&e.ctrlKey){var t=M.getState().canvas.canvas,a=M.getState().canvas.context;if(null!=t){var n=new q(t,a,!0,++Q.id);V.addFrame(n,100)}e.preventDefault()}}return Object(n.useEffect)((function(){var n=t.current.getContext("2d");return e.setCanvas(t.current,n),window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a)}}),[]),Object($.jsx)(s.a.Fragment,{children:Object($.jsx)("canvas",{ref:t,height:e.height,width:e.width,className:"canvas",style:{top:e.top,left:e.left,transform:"scale(".concat(e.canvasZoom,")")}})})})),te=a(17),ae=a(16),ne=function(){function e(t){Object(D.a)(this,e),this._listeners=t}return Object(U.a)(e,[{key:"addListener",value:function(e,t,a){var n={element:e,event:t,func:a};this._listeners.push(n),e.addEventListener(t,a)}},{key:"removeLastListener",value:function(){var e=this._listeners.pop();e.element.removeEventListener(e.event,e.func)}},{key:"removeListenersByEvent",value:function(e,t){for(var a=0;a<this._listeners.length;a++)if(this._listeners[a].event===t&&this._listeners[a].element===e){var n=this._listeners[a];n.element.removeEventListener(n.event,n.func),this._listeners.splice(a,1)}}},{key:"removeListener",value:function(e,t,a){for(var n=0;n<this._listeners.length;n++)if(this._listeners[n].event===t&&this._listeners[n].element===e&&JSON.stringify(this._listeners[n].func)===JSON.stringify(a)){var s=this._listeners[n];s.element.removeEventListener(s.event,s.func),this._listeners.splice(n,1)}}},{key:"removeAllListener",value:function(){for(;0!=this._listeners.length;){var e=this._listeners.pop();e.element.removeEventListener(e.event,e.func)}}}]),e}(),se=function(){function e(){Object(D.a)(this,e)}return Object(U.a)(e,null,[{key:"hexToRgb",value:function(e){return"#"===e[0]&&(e=e.slice(1)),"rgba("+parseInt(e.slice(0,2),16)+","+parseInt(e.slice(2,4),16)+","+parseInt(e.slice(4),16)+")"}},{key:"hexToRgba",value:function(e,t){return"#"===e[0]&&(e=e.slice(1)),"rgba("+parseInt(e.slice(0,2),16)+","+parseInt(e.slice(2,4),16)+","+parseInt(e.slice(4),16)+","+t+")"}},{key:"rgbToHex",value:function(e){return"#"+(e=e.replace(/[\s()rgba;]/gi,"").split(",").map((function(e,t,a){return 1===(e=parseInt(e,10).toString(16)).length&&(e="0"+e),e})).join(""))}},{key:"toRgba",value:function(t,a){if(t.startsWith("rgba")){var n=e.rgbaToHex(t);return e.hexToRgba(n,a)}if(t.startsWith("rgb")){var s=e.rgbToHex(t);return this.hexToRgba(s,a)}return this.hexToRgba(t,a)}},{key:"rgbaToHex",value:function(e){return"#"+(e=e.replace(/[\s()rgba;]/gi,"")).split(",").map((function(e,t,a){return t==a.length-1?"del":(1===(e=parseInt(e,10).toString(16)).length&&(e="0"+e),e)})).filter((function(e){return"del"!==e})).join("")}},{key:"toHex",value:function(t){return t.startsWith("#")?t:t.startsWith("rgba")?e.rgbaToHex(t):e.rgbToHex(t)}}]),e}(),ce=function(){function e(){Object(D.a)(this,e)}return Object(U.a)(e,[{key:"create",value:function(){}},{key:"destroy",value:function(){}},{key:"setLayout",value:function(e,t){this._canvas=e,this._ctx=t}}]),e}();function re(e){return{type:b,payload:e}}var ie=function(e){Object(te.a)(a,e);var t=Object(ae.a)(a);function a(){var e;return Object(D.a)(this,a),(e=t.call(this))._listenerManager=new ne(new Array),e}return Object(U.a)(a,[{key:"setColor",value:function(e){var t=M.getState();t.canvas.context;isFinite(t.brush.alpha)&&(e=se.toRgba(e,t.brush.alpha)),M.dispatch(re({color:e}))}},{key:"getColor",value:function(){var e=M.getState();return se.toHex(e.brush.color)}},{key:"setAlpha",value:function(e){e=Math.floor(100*e)/100,M.dispatch(re({alpha:e}));var t=M.getState();this.setColor(t.brush.color)}},{key:"getAlpha",value:function(){return M.getState().brush.alpha}},{key:"setSize",value:function(e){M.dispatch(re({size:e}))}},{key:"getSize",value:function(){return M.getState().brush.size}}]),a}(ce),oe=function(e){Object(te.a)(a,e);var t=Object(ae.a)(a);function a(){var e;Object(D.a)(this,a),(e=t.call(this)).started=!1;var n=M.getState();return e._canvasBlock=n.canvas.canvasBlock,e}return Object(U.a)(a,[{key:"create",value:function(){var e=this,t=[],a=document.createElement("canvas");this._fakeCanvas=a;var n=M.getState();a.style.zIndex=100,a.height=n.canvas.size.height,a.width=n.canvas.size.width,a.style.top=n.canvas.position.top,a.style.left=n.canvas.position.left,a.style.position="absolute",a.classList.add("tmpCanvas"),a.style.cursor="crosshair";var s=a.getContext("2d");function c(){if(this.started){this.started=!1,this._listenerManager.removeListener(a,"mousemove",r),this._ctx.drawImage(a,0,0);var e=M.getState();Q.update(),e.layouts.currentLayout.saveInHistory(),s.clearRect(0,0,a.width,a.height),t=[]}}this._canvasBlock.prepend(a),this._listenerManager.addListener(this._canvasBlock,"mousedown",(function(t){var n=M.getState();n.layouts.currentLayout.isHidden()?alert("\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u0432\u0430\u043c\u0438 \u0441\u043b\u043e\u0439 \u0441\u043a\u0440\u044b\u0442 !"):(e.started=!0,e._ctx=n.layouts.currentLayout.getContext(),e._canvas=n.layouts.currentLayout.getCanvas(),e._ctx.strokeStyle=n.brush.color,e._ctx.lineWidth=n.brush.size,e._ctx.lineCap="round",s.strokeStyle=e._ctx.strokeStyle,s.lineWidth=e._ctx.lineWidth,s.lineCap=e._ctx.lineCap,console.log(n.canvas.size.height),a.style.transform="scale(".concat(n.canvas.zoom,")"),a.style.top=n.canvas.position.top+"px",a.style.left=n.canvas.position.left+"px",r(t),e._listenerManager.addListener(a,"mousemove",r))})),this._listenerManager.addListener(this._canvasBlock,"mouseup",(function(){c.call(e)})),this._listenerManager.addListener(this._canvasBlock,"mouseleave",(function(){c.call(e)}));var r=function(a){var n=a.offsetX,c=a.offsetY;t.push({x:n,y:c}),s.beginPath(),s.clearRect(0,0,e._canvas.width,e._canvas.height),t.length<=3&&s.arc(t[0].x,t[0].y,0,0,2*Math.PI);for(var r=1;r<t.length-2;r++){var i=(t[r].x+t[r+1].x)/2,o=(t[r].y+t[r+1].y)/2;s.quadraticCurveTo(t[r].x,t[r].y,i,o)}s.stroke()}}},{key:"destroy",value:function(){this._listenerManager.removeAllListener(),this._fakeCanvas.remove()}}]),a}(ie),le=function(e){Object(te.a)(a,e);var t=Object(ae.a)(a);function a(){return Object(D.a)(this,a),t.call(this)}return Object(U.a)(a,[{key:"create",value:function(){var e=this,t=[],a=document.createElement("canvas");this._fakeCanvas=a;var n=M.getState();a.style.zIndex=100,a.height=n.canvas.size.height,a.width=n.canvas.size.width,a.style.transform="scale(".concat(n.canvas.zoom,")"),a.style.top=n.canvas.position.top,a.style.left=n.canvas.position.left,console.log(n.canvas.position.top),a.style.position="absolute",a.classList.add("tmpCanvas"),a.style.cursor="crosshair";var s=a.getContext("2d");n.canvas.canvasBlock.prepend(a),this._listenerManager.addListener(a,"mousedown",(function(t){var n=M.getState();e._ctx=n.layouts.currentLayout.getContext(),e._canvas=n.layouts.currentLayout.getCanvas(),e._ctx.lineWidth=n.brush.size,e._ctx.lineCap="round",s.lineWidth=e._ctx.lineWidth,s.lineCap=e._ctx.lineCap,e._ctx.strokeStyle=n.setting.canvasDefaultBackground,s.strokeStyle=n.setting.canvasDefaultBackground,c(t),e._listenerManager.addListener(a,"mousemove",c)})),this._listenerManager.addListener(a,"mouseup",(function(){e._listenerManager.removeListener(a,"mousemove",c);var r=function(e,t){for(var a=0;a<e.data.length;a+=4)255===e.data[a+3]&&(t.data[a+3]=0);return t}(s.getImageData(0,0,a.width,a.height),e._ctx.getImageData(0,0,a.width,a.height));e._ctx.putImageData(r,0,0),Q.update(),n.layouts.currentLayout.saveInHistory(),s.clearRect(0,0,a.width,a.height),t=[]}));var c=function(a){var n=a.offsetX,c=a.offsetY;t.push({x:n,y:c}),s.beginPath(),s.clearRect(0,0,e._canvas.width,e._canvas.height),t.length<=3&&s.arc(t[0].x,t[0].y,0,0,2*Math.PI);for(var r=1;r<t.length-2;r++){var i=(t[r].x+t[r+1].x)/2,o=(t[r].y+t[r+1].y)/2;s.quadraticCurveTo(t[r].x,t[r].y,i,o)}s.stroke()}}},{key:"destroy",value:function(){this._listenerManager.removeAllListener(),this._fakeCanvas.remove()}}]),a}(ie);var ue=function(e){Object(te.a)(a,e);var t=Object(ae.a)(a);function a(){var e;return Object(D.a)(this,a),(e=t.call(this))._listenerManager=new ne(new Array),e}return Object(U.a)(a,[{key:"create",value:function(){var e=this;console.log("create");var t=M.getState(),a=t.canvas.canvas,n=t.canvas.canvasBlock;console.log(n);var s=0,c=0;function r(e){var t=M.getState(),a=-(s-e.clientY),n=-(c-e.clientX);console.log(n),M.dispatch(T({top:parseInt(t.canvas.position.top)+a+"px",left:parseInt(t.canvas.position.left)+n+"px"})),s+=a,c+=n}a.style.cursor="move",this._listenerManager.addListener(a,"mousedown",(function(t){s=t.clientY,c=t.clientX,e._listenerManager.addListener(n,"mousemove",r)})),this._listenerManager.addListener(a,"mouseup",(function(t){e._listenerManager.removeListener(n,"mousemove",r),e._listenerManager.removeListener(n,"mouseleave",r)})),this._listenerManager.addListener(a,"mouseleave",(function(t){e._listenerManager.removeListener(n,"mousemove",r),e._listenerManager.removeListener(n,"mouseleave",r)})),this._listenerManager.addListener(a,"contextmenu",(function(){M.dispatch(A(1.5))}))}},{key:"destroy",value:function(){var e=M.getState().canvas.canvas;this._listenerManager.removeAllListener(),e.style.cursor="default"}}]),a}(ce),de=function(){function e(){Object(D.a)(this,e)}return Object(U.a)(e,null,[{key:"setTool",value:function(e){console.log("wtf SET TOOL"+e);var t=M.getState().canvas.currentTool;switch(t&&t.destroy(),e){case"SCETCH_BRUSH":var a=new oe;a.create(),M.dispatch(w(a,"SCETCH_BRUSH"));break;case"ERASER":var n=new le;n.create(),M.dispatch(w(n,"ERASER"));break;case"HAND":var s=new ue;s.create(),M.dispatch(w(s,"HAND"));break;default:var c=new oe;c.create(),M.dispatch(w(c,"SCETCH_BRUSH"))}}},{key:"saveBrush",value:function(e){M.dispatch({type:m,payload:e})}},{key:"changeSavedBrushes",value:function(e){M.dispatch({type:g,payload:e})}},{key:"getTool",value:function(){return M.getState().canvas.currentTool}}]),e}();var he=Object(o.b)((function(e){return{canvas:e.canvas.canvas,context:e.canvas.context,defaultBackgorund:e.setting.canvasDefaultBackground,currentLayout:e.layouts.currentLayout,currentToolName:e.canvas.currentToolName}}),(function(e){return{changeCanvasSize:Object(l.a)(S,e),setCanvasBlock:Object(l.a)(I,e)}}))((function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){console.log("first load canvas");var a=getComputedStyle(t.current);e.changeCanvasSize(parseInt(a.width)-2,parseInt(a.height)-2),null!==e.canvas&&(e.setCanvasBlock(t.current),de.setTool(e.currentToolName),Q.init())}),[e.canvas]),Object($.jsx)("div",{ref:t,className:"work-space",style:{backgroundColor:e.defaultBackgorund},children:Object($.jsx)(ee,{})})}));a(43);function ve(e){return Object($.jsxs)("div",{className:"top-panel",children:[Object($.jsx)("div",{className:"top-panel__logo"}),e.children]})}var fe=a(4),je=a(9);a(44);function be(e){var t;switch(Object(fe.g)().pathname.match(/\/\w+/)[0]){case"/draw":t=Object($.jsxs)($.Fragment,{children:[Object($.jsx)(je.b,{to:"/save",className:"top-panel__menu-item",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object($.jsx)(je.b,{to:"/frames",className:"top-panel__menu-item",children:"\u0420\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043a\u0430\u0434\u0440\u0430\u043c\u0438"})]});break;case"/frames":t=Object($.jsxs)($.Fragment,{children:[Object($.jsx)(je.b,{to:"/save",className:"top-panel__menu-item",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object($.jsx)(je.b,{to:"/draw",className:"top-panel__menu-item",children:"\u0420\u0438\u0441\u043e\u0432\u0430\u0442\u044c"})]});break;case"/save":t=Object($.jsxs)($.Fragment,{children:[Object($.jsx)(je.b,{to:"/draw",className:"top-panel__menu-item",children:"\u0420\u0438\u0441\u043e\u0432\u0430\u0442\u044c"}),Object($.jsx)(je.b,{to:"/frames",className:"top-panel__menu-item",children:"\u0420\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043a\u0430\u0434\u0440\u0430\u043c\u0438"})]});break;default:t=Object($.jsx)(je.b,{to:"/draw",className:"top-panel__menu-item",children:"draw"})}return Object($.jsxs)("div",{className:"top-panel__menu",children:[Object($.jsx)("div",{className:"top-panel__menu-item",children:"\u0424\u0430\u0439\u043b"}),t]})}a(49),a(50);var me=function(e){return Object($.jsxs)("div",{className:"brush-panel__block size-block",children:[Object($.jsx)("div",{className:"brush-panel__panel-titile",children:e.title}),Object($.jsxs)("div",{className:"brush-panel__inputs-block",children:[Object($.jsx)("input",{min:e.min,max:e.max,step:e.step,onChange:e.onChange,value:e.value,type:"number"}),Object($.jsx)("input",{min:e.min,max:e.max,step:e.step,onChange:e.onChange,value:e.value,type:"range"})]})]})};var pe=Object(o.b)((function(e){return{brushSize:e.brush.size,brushColor:e.brush.color,brushAlpha:e.brush.alpha,savedBrushes:e.brush.savedBrushes}}))((function(e){var t=null,a=Object(n.useRef)();return Object($.jsxs)("div",{className:"brush-panel__block",children:[Object($.jsx)("div",{className:"brush-panel__panel-titile",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0435 \u043a\u0438\u0441\u0442\u0438"}),Object($.jsxs)("div",{className:"brush-panel__saved-brush",children:[Object($.jsxs)("div",{ref:a,className:"brush-panel__saved-brush-menu ",children:[Object($.jsx)("div",{onClick:function(){e.savedBrushes[t].size=e.brushSize,e.savedBrushes[t].color=e.brushColor,e.savedBrushes[t].alpha=e.brushAlpha,de.changeSavedBrushes(e.savedBrushes),a.current.classList.add("fastRemove"),a.current.classList.remove("active"),setTimeout((function(){a.current.classList.remove("fastRemove")}),0)},className:"brush-panel__saved-brush-menu-item",children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"}),Object($.jsx)("div",{onClick:function(){e.savedBrushes.splice(t,1),de.changeSavedBrushes(e.savedBrushes),a.current.classList.add("fastRemove"),a.current.classList.remove("active"),setTimeout((function(){a.current.classList.remove("fastRemove")}),0)},className:"brush-panel__saved-brush-menu-item",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]}),e.savedBrushes.map((function(n,s){return Object($.jsxs)("div",{onClick:function(){!function(t){var a=e.savedBrushes[t],n=de.getTool();n.setColor(a.color),n.setSize(a.size),n.setAlpha(a.alpha)}(s)},onContextMenu:function(e){!function(e,n){t=n,a.current.classList.add("active");var s,c=e.target.getBoundingClientRect();a.current.style.top=c.top+"px",a.current.style.left=c.left+"px",a.current.addEventListener("mouseleave",(function(){a.current.classList.add("fastRemove"),a.current.classList.remove("active"),setTimeout((function(){a.current.classList.remove("fastRemove")}),0)})),e.preventDefault(),s=setTimeout((function(){a.current.classList.remove("active")}),500),a.current.addEventListener("mouseenter",(function(e){clearTimeout(s),a.current.classList.add("active")}))}(e,s)},style:{backgroundColor:n.color},className:"brush-panel__saved-brush-item",children:["s:",n.size," o:",n.alpha]},s)}))]})]})}));var ge=Object(o.b)((function(e){return{brushSize:e.brush.size,brushColor:e.brush.color,brushAlpha:e.brush.alpha,savedBrushes:e.brush.savedBrushes}}))((function(e){return Object($.jsxs)("div",{className:"brush-panel",children:[Object($.jsx)(me,{title:"\u0420\u0430\u0437\u043c\u0435\u0440 \u043a\u0438\u0441\u0442\u0438",value:e.brushSize,onChange:function(e){de.getTool().setSize(e.target.value)},max:"250",min:"0",step:"1"}),Object($.jsx)(me,{title:"\u041f\u0440\u043e\u0437\u0440\u0430\u0447\u043d\u043e\u0441\u0442\u044c",value:e.brushAlpha,onChange:function(e){de.getTool().setAlpha(e.target.value)},max:"1",min:"0",step:"0.01"}),Object($.jsxs)("div",{className:"brush-panel__block",children:[Object($.jsx)("div",{className:"brush-panel__panel-titile",children:"\u0426\u0432\u0435\u0442 \u043a\u0438\u0441\u0442\u0438"}),Object($.jsxs)("div",{className:"brush-panel__inputs-block",children:[Object($.jsx)("input",{onChange:function(e){de.getTool().setColor(e.target.value)},value:se.toHex(e.brushColor),type:"color"}),Object($.jsx)("input",{value:se.toHex(e.brushColor),type:"text"})]}),Object($.jsx)("button",{onClick:function(t){de.saveBrush({color:e.brushColor,alpha:e.brushAlpha,size:e.brushSize})},className:"panel__block-button",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]}),Object($.jsx)(pe,{})]})}));a(51);var ye=Object(o.b)((function(e){return{canvasZoom:e.canvas.zoom,top:e.canvas.position.top,left:e.canvas.position.left,canvasSize:e.canvas.size}}),(function(e){return{setCanvasZoom:Object(l.a)(A,e),setCanvasPosition:Object(l.a)(T,e)}}))((function(e){return Object($.jsxs)("div",{className:"top-panel__setting-hand-tool",children:[Object($.jsx)("div",{children:Object($.jsx)(me,{title:"\u0423\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u0435",onChange:function(t){console.log(t.currentTarget),e.setCanvasZoom(t.currentTarget.value)},max:"5",min:"0.1",step:"0.1",value:e.canvasZoom})}),Object($.jsx)("div",{children:Object($.jsx)(me,{title:"x \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u0430",onChange:function(t){e.setCanvasPosition({top:e.top,left:t.currentTarget.value+"px"})},max:parseInt(e.canvasSize.width),min:-parseInt(e.canvasSize.width),step:"1",value:parseInt(e.left)})}),Object($.jsx)("div",{children:Object($.jsx)(me,{title:"y \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u0430",onChange:function(t){e.setCanvasPosition({top:t.currentTarget.value+"px",left:e.left})},max:parseInt(e.canvasSize.height),min:-parseInt(e.canvasSize.height),step:"1",value:parseInt(e.top)})}),Object($.jsx)("div",{children:Object($.jsx)("button",{onClick:function(){e.setCanvasPosition({top:"1px",left:"1px"})},children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c \u043f\u043e \u0446\u0435\u043d\u0442\u0440\u0443"})})]})}));var xe=Object(o.b)((function(e){return{currentToolName:e.canvas.currentToolName}}))((function(e){return"HAND"===e.currentToolName?Object($.jsx)(ye,{}):Object($.jsx)(ge,{})}));a(52);var Oe=function(e){return Object($.jsx)("div",{className:"left-panel",children:e.children})};a(53);var _e=Object(o.b)((function(e){return{currentToolName:e.canvas.currentToolName}}))((function(e){return Object($.jsxs)($.Fragment,{children:[Object($.jsx)("div",{onClick:function(){de.setTool("SCETCH_BRUSH")},className:"SCETCH_BRUSH"===e.currentToolName?"left-panel__tool-item active":"left-panel__tool-item",children:Object($.jsx)("img",{src:"./img/brush.svg",alt:""})}),Object($.jsx)("div",{onClick:function(){de.setTool("ERASER")},className:"ERASER"===e.currentToolName?"left-panel__tool-item active":"left-panel__tool-item",children:Object($.jsx)("img",{src:"./img/eraser.svg",alt:""})}),Object($.jsx)("div",{onClick:function(){de.setTool("HAND")},className:"HAND"===e.currentToolName?"left-panel__tool-item active":"left-panel__tool-item",children:Object($.jsx)("img",{src:"./img/hand.svg",alt:""})})]})}));a(54);var Ce=function(e){return Object($.jsx)("div",{className:"right-panel",children:e.children})},ke=a(8);a(55),a(56);var Le=Object(o.b)((function(e){return{defaultBackgorund:e.setting.canvasDefaultBackground}}))((function(e){var t=e.layout,a=t.getCanvas(),s=Object(n.useRef)(),c=e.index;return Object(n.useEffect)((function(){return console.log("render layout"),s.current.append(a),a.style.backgroundColor=e.defaultBackgorund,a.style.outline=e.isCurrent?"10px solid red":"none",function(){a.remove()}})),Object($.jsxs)("div",{onContextMenu:function(a){if(t.isSelected()){e.setMenuActive(!0);var n=a.pageY-10,s=a.pageX-20;s+200>=window.innerWidth&&(s=window.innerWidth-200),e.setMenuPosition({x:n,y:s})}a.stopPropagation(),a.preventDefault()},ref:s,onClick:function(e){e.ctrlKey?Q.select(c):(Q.setCurrentLayout(c),e.stopPropagation())},style:e.isSelected?{backgroundColor:"darkred"}:{backgroundColor:"black"},className:"right-panel__layout-block layout-block",children:[Object($.jsxs)("div",{className:"layout-block__left-menu",children:[Object($.jsx)("div",{onClick:function(e){Q.swap(c,c-1),e.stopPropagation()},className:"layout-block__left-menu-item",children:Object($.jsx)("img",{src:"./img/up.svg",alt:""})}),Object($.jsx)("div",{onClick:function(e){Q.toggleHide(c),e.stopPropagation()},className:"layout-block__left-menu-item",children:e.isHidden?Object($.jsx)("img",{src:"./img/hide.svg",alt:""}):Object($.jsx)("img",{src:"./img/show.svg",alt:""})}),Object($.jsx)("div",{onClick:function(e){Q.deleteLayout(c),e.stopPropagation()},className:"layout-block__left-menu-item",children:Object($.jsx)("img",{src:"./img/delete.svg",alt:""})}),Object($.jsx)("div",{onClick:function(e){Q.swap(c,c+1),e.stopPropagation()},className:"layout-block__left-menu-item",children:Object($.jsx)("img",{src:"./img/up.svg",alt:"",style:{transform:"rotateX(180deg)"}})})]}),Object($.jsxs)("div",{className:"layout-block__bottom-menu",children:[Object($.jsx)("div",{className:"layout-block__bottom-menu-item history",children:"History"}),Object($.jsx)("div",{onClick:function(e){t.historyBack(),Q.update(),e.stopPropagation()},className:"layout-block__bottom-menu-item back",children:Object($.jsx)("img",{src:"./img/up.svg",alt:"",style:{transform:"rotateZ(-90deg)"}})}),Object($.jsx)("div",{onClick:function(){V.addFrame(t,100)},className:"layout-block__bottom-menu-item favorites",children:"\u0414\u043b\u044f \u043c\u0443\u043b\u044c\u0442\u0430"}),Object($.jsx)("div",{onClick:function(e){t.historyNext(),Q.update(),e.stopPropagation()},className:"layout-block__bottom-menu-item next",children:Object($.jsx)("img",{src:"./img/up.svg",alt:"",style:{transform:"rotateZ(90deg)"}})})]})]},c)}));a(57);var Se=function(e){return Object($.jsx)("div",{className:e.active?"context-menu active":"context-menu",onMouseLeave:function(){e.setMenuActive(!1)},style:{top:e.menuPosition.x,left:e.menuPosition.y},children:e.children})};var Ne=Object(o.b)((function(e){return{layoutList:e.layouts.layoutList,currentLayoutIndex:e.layouts.currentLayoutIndex,canvas:e.canvas.canvas,context:e.canvas.context}}))((function(e){var t=Object(n.useState)({x:0,y:0}),a=Object(ke.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)(!1),o=Object(ke.a)(i,2),l=o[0],u=o[1],d=Object($.jsxs)(Se,{setMenuActive:u,active:l,menuPosition:s,children:[Object($.jsx)("div",{onClick:function(t){u(!1);var a=[];console.log(e.layoutList),e.layoutList.map((function(e,t){return e.isSelected()&&a.push(t),e})),Q.deleteLayouts(a)},className:"right-panel__context-menu-item",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),Object($.jsx)("div",{onClick:function(t){u(!1);var a=[];e.layoutList.map((function(e,t){return e.isSelected()&&a.push(t),e})),Q.combine(a)},className:"right-panel__context-menu-item",children:"\u041e\u0431\u044c\u0435\u0434\u0435\u043d\u0438\u0442\u044c"}),Object($.jsx)("div",{onClick:function(){Q.unSelectAll()},className:"right-panel__context-menu-item",children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435"})]});return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)("div",{className:"right-panel__layout-buttons",children:[Object($.jsx)("button",{onClick:function(){var t=new q(e.canvas,e.context,!0,++Q.id);Q.addLayout(t)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0439"}),Object($.jsx)("button",{onClick:function(t){var a=new q(e.canvas,e.context,!0,++Q.id);V.addFrame(a,100)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u0430\u0434\u0440\u044b"})]}),r.a.createPortal(d,document.getElementById("root")),Object($.jsx)("div",{className:"right-panel__layout-list",children:e.layoutList.map((function(t,a){return Object($.jsx)(Le,{layout:t,index:a,isCurrent:a===e.currentLayoutIndex,isHidden:t.isHidden(),isSelected:t.isSelected(),setMenuPosition:c,setMenuActive:u},t.getId())}))})]})}));a(58),a(59);var we=Object(o.b)((function(e){return{currentFrameIndex:e.frames.currentFrameIndex,defaultBackgorund:e.setting.canvasDefaultBackground,layoutList:e.layouts.layoutList}}))((function(e){var t=e.value,a=t.getId(),c=e.index,r=s.a.createRef();Object(n.useEffect)((function(){return e.isOpen&&(r.current.prepend(t.getCanvas()),t.getCanvas().style.backgroundColor=e.defaultBackgorund),function(){t.getCanvas().remove()}}),[a,e.defaultBackgorund,t,e.isOpen,r.current]);var i=e.isOpen?"frame-block opened":"frame-block";return i=e.isSelected?i+" selected":i,Object($.jsxs)("div",{ref:r,className:i,style:e.currentFrameIndex===c?{background:"darkred"}:{},onClick:function(a){if(a.ctrlKey)return e.isSelected?t.unSelect():t.select(),V.changeFrame(),void a.stopPropagation();V.set\u0421urrentFrameIndex(c)},onContextMenu:function(t){if(e.isSelected){var a=t.pageY-10,n=t.pageX-20;n+200>=window.innerWidth&&(n=window.innerWidth-200),e.setMenuPosition({x:a,y:n}),e.setMenuActive(!0)}t.preventDefault(),t.stopPropagation()},children:[Object($.jsx)("span",{className:"frame-block__index",children:e.index+1}),Object($.jsx)("div",{className:"frame-block__open-close-btn",onClick:function(e){V.openCloseFrame(t),e.stopPropagation()}}),Object($.jsxs)("div",{className:"frame-block__menu frame-menu",children:[Object($.jsx)("div",{onClickCapture:function(e){V.swap(c,c-1),e.stopPropagation()},className:"frame-menu__item",children:Object($.jsx)("img",{src:"./img/up.svg",alt:""})}),Object($.jsx)("div",{className:"frame-menu__item",children:Object($.jsx)("button",{onClickCapture:function(a){var n=document.createElement("canvas");n.width=t.getCanvas().width,n.height=t.getCanvas().height;var s=n.getContext("2d");s.drawImage(t.getCanvas(),0,0);var c=new q(n,s,!0,++Q.id);e.layoutList.push(c),Q.changeLayoutList(e.layoutList),a.stopPropagation()},children:"\u0412 \u0441\u043b\u043e\u0438"})}),Object($.jsx)("div",{onClickCapture:function(e){V.swap(c,c+1),e.stopPropagation()},className:"frame-menu__item down-arrow",children:Object($.jsx)("img",{src:"./img/up.svg",alt:""})})]}),Object($.jsxs)("div",{className:"frame-block__input-block",children:[Object($.jsx)("h2",{children:"\u0417\u0430\u0434\u0435\u0440\u0436\u043a\u0430"}),Object($.jsx)("input",{onClickCapture:function(e){return e.stopPropagation()},value:t.getDelay(),onChange:function(e){var a=e.currentTarget.value;t.setDelay(a),V.changeFrame(c,t),e.stopPropagation()},min:"0",type:"number"})]}),Object($.jsx)("div",{className:"frame-block__delete-btn",children:Object($.jsx)("img",{onClickCapture:function(e){V.deleteFrame(c),e.stopPropagation()},src:"./img/delete.svg",alt:""})})]})}));a(60);var Ie=Object(o.b)((function(e){return{frameList:e.frames.frameList}}))((function(e){var t=Object(n.useState)(!1),a=Object(ke.a)(t,2),s=a[0],c=a[1],i=Object(n.useState)({x:"0px",y:"0px"}),o=Object(ke.a)(i,2),l=o[0],u=o[1],d=Object(n.useState)(100),h=Object(ke.a)(d,2),v=h[0],f=h[1],j=Object($.jsxs)(Se,{active:s,setMenuActive:c,menuPosition:l,children:[Object($.jsxs)("div",{className:"context-menu-item",children:[Object($.jsx)("div",{children:"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0443"}),Object($.jsxs)("div",{children:[Object($.jsx)("input",{className:"context-menu-item__input",value:v,onChange:function(e){f(e.currentTarget.value)},type:"number"}),Object($.jsx)("button",{onClick:function(e){c(!1),V.setDelaySelectedFrames(v)},children:"OK"})]})]}),Object($.jsx)("div",{className:"context-menu-item",onClick:function(){c(!1),window.confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u043a\u0430\u0434\u0440\u044b ?")&&V.deleteSelectedFrame()},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435"}),Object($.jsx)("div",{className:"context-menu-item",onClick:function(){c(!1),V.unSelectAllFrame()},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u0435"})]});return Object($.jsxs)("div",{className:"right-panel__frames",children:[r.a.createPortal(Object($.jsx)($.Fragment,{children:j}),document.getElementById("root")),e.frameList.map((function(e,t){return Object($.jsx)(we,{value:e,index:t,delay:e.getDelay(),isOpen:e.isOpen(),isSelected:e.isSelected(),setMenuActive:c,setMenuPosition:u},e.getId())}))]})}));function Te(e){var t=Object(n.useState)(0),a=Object(ke.a)(t,2),s=a[0],c=a[1],r=e.setContent;return Object(n.useEffect)((function(){switch(s){case 0:r(Object($.jsx)(Ne,{}));break;case 1:r("history");break;case 2:r(Object($.jsx)(Ie,{}))}}),[s,r]),Object($.jsx)($.Fragment,{children:Object($.jsxs)("div",{className:"right-panel__tabs",children:[Object($.jsx)("button",{onClick:function(){c(0)},className:0===s?"right-panel__tabs-button active":"right-panel__tabs-button",children:"\u0421\u043b\u043e\u0438"}),Object($.jsx)("button",{onClick:function(){c(2)},className:2===s?"right-panel__tabs-button active":"right-panel__tabs-button",children:"\u041a\u0430\u0434\u0440\u044b"})]})})}var Ae=Object(o.b)()((function(){var e=Object(n.useState)(Object($.jsx)(Ne,{})),t=Object(ke.a)(e,2),a=t[0],s=t[1];return Object($.jsxs)($.Fragment,{children:[Object($.jsx)(Te,{setContent:s}),a]})}));a(61);var Ee=function(e){return Object($.jsx)("div",{className:"center-space",children:e.children})};function He(){return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)(ve,{children:[Object($.jsx)(be,{}),Object($.jsx)(xe,{})]}),Object($.jsx)(Oe,{children:Object($.jsx)(_e,{})}),Object($.jsx)(Ce,{children:Object($.jsx)(Ae,{})}),Object($.jsx)(Ee,{children:Object($.jsx)(he,{})})]})}var Be=Object(o.b)((function(e){return{drawCanvas:e.canvas.canvas,frameList:e.frames.frameList,currentFrameIndex:e.frames.currentFrameIndex}}))((function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){return V.setMultiplicateCanvas(t.current),function(){V.pause()}}),[]),Object(n.useEffect)((function(){if(0!==e.frameList.length){var a=t.current.getContext("2d");!function t(){if(!e.frameList[e.currentFrameIndex])return;a.clearRect(0,0,e.drawCanvas.width,e.drawCanvas.height),a.drawImage(e.frameList[e.currentFrameIndex].getCanvas(),0,0),requestAnimationFrame(t)}()}})),Object($.jsx)($.Fragment,{children:Object($.jsx)("canvas",{ref:t,width:e.drawCanvas.width,height:e.drawCanvas.height})})}));function Fe(){var e=Object(n.useState)(100),t=Object(ke.a)(e,2),a=t[0],s=t[1];return Object($.jsxs)($.Fragment,{children:[Object($.jsxs)("div",{children:[Object($.jsx)("h3",{children:"\u0423\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0435\u0440\u0436\u043a\u0443 \u0434\u043b\u044f \u0432\u0441\u0435\u0445 \u0441\u043b\u043e\u0435\u0432"}),Object($.jsx)("input",{type:"number",value:a,onChange:function(e){s(e.currentTarget.value)}}),Object($.jsx)("button",{onClick:function(){V.setDelayToAll(a)},children:"OK"})]}),Object($.jsx)(Ie,{})]})}a(62);var Re=Object(o.b)(null,{canPlay:function(){return{type:k}}})((function(e){return Object($.jsxs)("div",{className:"top-panel-buttons",children:[Object($.jsx)("button",{className:"pause-button",onClick:function(){V.pause()}}),Object($.jsx)("button",{className:"play-button",onClick:function(){e.canPlay(),V.playFilm()}})]})}));a(63);var ze=Object(o.b)((function(e){return{currentFrameIndex:e.frames.currentFrameIndex,frameList:e.frames.frameList}}))((function(e){return Object($.jsx)("div",{className:"top-panel-inputs-block",children:Object($.jsx)(me,{title:"\u0424\u0440\u044d\u0439\u043c\u044b",onChange:function(e){V.set\u0421urrentFrameIndex(+e.target.value)},value:e.currentFrameIndex,min:"0",max:e.frameList.length-1,step:"1"})})}));a(64);function Pe(){return Object($.jsx)($.Fragment,{children:Object($.jsxs)("div",{className:"top-panel-content",children:[Object($.jsx)(Re,{}),Object($.jsx)(ze,{})]})})}function Me(){return Object($.jsxs)("div",{children:[Object($.jsxs)(ve,{children:[Object($.jsx)(be,{}),Object($.jsx)(Pe,{})]}),Object($.jsx)(Ce,{children:Object($.jsx)(Fe,{})}),Object($.jsx)(Ee,{children:Object($.jsx)(Be,{})}),Object($.jsx)(Oe,{})]})}function De(e){var t=M.getState();return Object($.jsx)("div",{children:null===t.canvas.canvas?Object($.jsx)(fe.a,{to:"/draw"}):Object($.jsx)(Me,{})})}a(65),a(66);var Ue=function(e){return Object($.jsxs)("div",{className:"top-panel__save-tabs save-tabs",children:[Object($.jsx)(je.b,{to:"/save/gif",className:"save-tabs__item",children:"Gif"}),Object($.jsx)(je.b,{to:"/save/jpg",className:"save-tabs__item",children:"Jpg"}),Object($.jsx)(je.b,{to:"/save/png",className:"save-tabs__item",children:"Png"})]})},We=(a(67),a(27)),Ge=a.n(We),Ye=(a(68),a.p+"static/media/preloader.279ed7ee.gif");var Ze=function(e){return Object($.jsxs)("div",{className:"preloader",children:[Object($.jsx)("h2",{children:"\u0418\u0434\u0435\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."}),Object($.jsx)("img",{className:"preloader__img",src:Ye,alt:""})]})};var Ve=Object(o.b)((function(e){return{frameList:e.frames.frameList,width:parseInt(e.canvas.size.width),height:parseInt(e.canvas.size.height)}}))((function(e){var t=Object(n.useState)(0),a=Object(ke.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)(10),i=Object(ke.a)(r,2),o=i[0],l=i[1],u=Object(n.useState)(e.width),d=Object(ke.a)(u,2),h=d[0],v=d[1],f=Object(n.useState)(e.height),j=Object(ke.a)(f,2),b=j[0],m=j[1],p=Object(n.useState)("#ffffff"),g=Object(ke.a)(p,2),y=g[0],x=g[1],O=Object(n.useState)(!1),_=Object(ke.a)(O,2),C=_[0],k=_[1],L=Object(n.useState)(!0),S=Object(ke.a)(L,2),N=S[0],w=S[1];return Object($.jsxs)("div",{className:"save-gif-panel",children:[Object($.jsxs)("div",{className:"save-gif-panel__row",children:[Object($.jsxs)("div",{className:"save-gif-panel__item",children:[Object($.jsx)("h4",{children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439 \u0434\u043b\u044f gif. \u0415\u0441\u043b\u0438 -1, \u0442\u043e \u0431\u0435\u0437 \u043f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u0439. \u0415\u0441\u043b\u0438 0 - \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u0442\u044c \u0431\u0435\u0441\u043a\u043e\u043d\u0435\u0447\u043d\u043e "}),Object($.jsx)(me,{title:"\u041f\u043e\u0432\u0442\u043e\u0440\u0435\u043d\u0438\u044f",max:"1000",min:"-1",step:"1",value:s,onChange:function(e){return c(e.currentTarget.value)}})]}),Object($.jsxs)("div",{className:"save-gif-panel__item",children:[Object($.jsx)("h4",{children:"\u0418\u043d\u0442\u0435\u0440\u0432\u0430\u043b \u0432\u044b\u0431\u043e\u0440\u043a\u0438 \u043f\u0438\u043a\u0441\u0435\u043b\u0435\u0439. \u0427\u0435\u043c \u043c\u0435\u043d\u044c\u0448\u0435, \u0442\u0435\u043c \u043b\u0443\u0447\u0448\u0435"}),Object($.jsx)(me,{title:"\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e",max:"100",min:"1",step:"1",value:o,onChange:function(e){return l(e.currentTarget.value)}})]})]}),Object($.jsxs)("div",{className:"save-gif-panel__row",children:[Object($.jsxs)("div",{className:"save-gif-panel__size",children:[Object($.jsxs)("div",{className:"save-gif-panel__item",children:[Object($.jsx)("span",{children:"\u0421\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0438"}),Object($.jsx)("input",{type:"checkbox",checked:N,onChange:function(e){console.log(e.currentTarget.checked),w(e.currentTarget.checked)}})]}),Object($.jsx)("div",{className:"save-gif-panel__item",children:Object($.jsx)(me,{title:"\u0428\u0438\u0440\u0438\u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438",max:"2000",min:"0",step:"1",value:h,onChange:function(t){v(t.currentTarget.value),N&&m(t.currentTarget.value*e.height/e.width)}})}),Object($.jsx)("div",{className:"save-gif-panel__item",children:Object($.jsx)(me,{title:"\u0412\u044b\u0441\u043e\u0442\u0430",max:"2000",min:"0",step:"1",value:b,onChange:function(t){m(t.currentTarget.value),N&&v(t.currentTarget.value*e.width/e.height)}})})]}),Object($.jsxs)("div",{className:"save-gif-panel__color",children:[Object($.jsx)("h4",{children:"\u0426\u0432\u0435\u0442 \u0444\u043e\u043d\u0430"}),Object($.jsx)("input",{className:"save-gif-panel__color-input",type:"color",value:y,onChange:function(e){x(e.currentTarget.value)}})]})]}),Object($.jsx)("div",{className:"save-gif-panel__row",children:Object($.jsx)("div",{className:"save-gif-panel__save-btn-wrapper",children:C?Object($.jsx)(Ze,{}):Object($.jsx)("button",{className:"save-gif-panel__save-btn",onClick:function(){var t=e.frameList;if(0!==t.length){k(!0);var a=new Ge.a({workers:2,quality:o,repeat:s});t.forEach((function(e,t){var n=document.createElement("canvas");n.width=h,n.height=b;var s=n.getContext("2d");s.fillStyle=y,s.fillRect(0,0,h,b),s.drawImage(e.getCanvas(),0,0,h,b),a.addFrame(n,{delay:e.getDelay(),copy:!0})})),a.on("finished",(function(e){k(!1),window.open(URL.createObjectURL(e))})),a.render()}else alert("\u0421\u043f\u0438\u0441\u043e\u043a \u0444\u0440\u0435\u0439\u043c\u043e\u0432 \u043f\u0443\u0441\u0442 !")},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c !"})})})]})}));var Ke=function(e){return Object($.jsxs)("div",{className:"save-window",children:[Object($.jsxs)(ve,{children:[Object($.jsx)(be,{}),Object($.jsx)(Ue,{})]}),Object($.jsx)(Oe,{}),Object($.jsx)(Ce,{}),Object($.jsxs)(Ee,{children:[Object($.jsx)(fe.b,{path:"/save/gif",children:Object($.jsx)(Ve,{})}),Object($.jsx)(fe.b,{path:"/save/jpg",children:Object($.jsx)("div",{children:"JPG"})}),Object($.jsx)(fe.b,{path:"/save/png",children:Object($.jsx)("div",{children:"PNG"})}),Object($.jsx)(fe.b,{exact:!0,path:"/save",children:Object($.jsx)("div",{className:"save-window__file-type-title",children:Object($.jsx)("h1",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u0438\u043f \u0444\u0430\u0439\u043b\u0430"})})})]})]})};var Xe=Object(o.b)()((function(){return console.log("public_url"),console.log("".concat("/React-Multiplicate")),Object($.jsx)(je.a,{basemname:"".concat("/React-Multiplicate"),children:Object($.jsx)("div",{className:"main",children:Object($.jsxs)(fe.d,{children:[Object($.jsx)(fe.b,{exact:!0,path:"/draw",render:function(){return Object($.jsx)(He,{})}}),Object($.jsx)(fe.b,{path:"/frames",render:function(){return Object($.jsx)(De,{})}}),Object($.jsx)(fe.b,{path:"/save",render:function(){return Object($.jsx)(Ke,{})}}),Object($.jsx)(fe.a,{from:"/",to:"/draw"})]})})})}));r.a.render(Object($.jsx)(s.a.StrictMode,{children:Object($.jsx)(o.a,{store:M,children:Object($.jsx)(Xe,{})})}),document.getElementById("root")),i()}]),[[69,1,2]]]);
//# sourceMappingURL=main.12d4f69a.chunk.js.map